const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BZXJPhY7.js","assets/index-CfYeSufM.js","assets/index-CFKgBu5P.js","assets/ExpandToggle-BWvLSvN8.js","assets/index-f57OK8O5.js","assets/geometryEngineJSON-Bvf5zUh7.js","assets/geometryEngineBase-B0ZyeKAX.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/json-Wa8cmqdu.js","assets/index-Brmf-FJp.js","assets/index-5A6Q9Ymv.js","assets/index-DlQs6GcF.js","assets/index-Dua-T4iP.js","assets/index-DSKdqVJd.js","assets/index-HnPKUUfx.js","assets/Legend-Ce1JJ1sy.js","assets/featureReductionUtils-Caulfaw_.js","assets/EffectView-Jcs4MyZ6.js","assets/ExportImageParameters-BX_m3R7l.js","assets/floorFilterUtils-DZ5C6FQv.js","assets/sublayerUtils--mHU41N0.js","assets/pixelRangeUtils-Bk2sXCMF.js","assets/rendererConversion-BFQl1ElB.js","assets/cimSymbolUtils-Bu2r_l8n.js","assets/symbolUtils-DzBXc-Wp.js","assets/utils-BhrB4brX.js","assets/utils-L9BGy6Hj.js","assets/webStyleSymbolUtils-C0OVnxdp.js","assets/devEnvironmentUtils-CnNDiFMM.js","assets/substitute-o343UI2L.js","assets/index-DDVACUeq.js","assets/GridControls-_d27-0p8.js","assets/defaultUnit-mAXf9frj.js","assets/quantityFormatUtils-D4QC4M5H.js","assets/gridUtils-Beoh8Lyq.js","assets/geodesicUtils-AyGMpq1K.js","assets/editingTools-Ch-vsZhH.js","assets/SnappingVisualizer2D-BlNHuATY.js","assets/SnappingManager-uFSx-TIH.js","assets/keybindings-CtvTi62R.js","assets/geometry2dUtils-BECZf0GS.js","assets/viewUtils-D24sG8PY.js","assets/SnappingVisualizer-yY-u8LGd.js","assets/PointSnappingHint-DFT7U_tQ.js","assets/editPlaneUtils-CZLCDjdA.js","assets/SketchTooltipInfo-nGjeMflC.js","assets/MeshTransform-CpEmJDpm.js","assets/memoize-DmxaQ-k8.js","assets/angularMeasurementUtils-qlhFG6W2.js","assets/directionModeIcons-H3VlGLqc.js","assets/ReactiveSet-CYtgD1tN.js","assets/dehydratedFeatureComparison-Cqp8Y6mL.js","assets/EditGeometryOperations-wQHypEHr.js","assets/InteractiveToolBase-XZur83Y0.js","assets/SketchOptions-_RdOU_mt.js","assets/SnappingOperation-DKQngwsY.js","assets/geometryEngine-DZQmjC3o.js","assets/hydrated-8eZrnzf3.js","assets/GraphicsLayer-C8-bjLvb.js","assets/automaticAreaMeasurementUtils-D2fbyRWB.js","assets/geodesicLengthMeasurementUtils-BMbcKd8T.js","assets/euclideanAreaMeasurementUtils-Bq7qOqGe.js","assets/automaticLengthMeasurementUtils-Bwa3LUxz.js","assets/GraphicManipulator--7x_0vOG.js","assets/drapedUtils-DkjinvLd.js","assets/drawUtils-zB07QfdF.js","assets/TextOverlayItem-qJgBhmzl.js","assets/number-CRXbdJTy.js","assets/SketchViewModel-B2klnA_y.js","assets/vmEvent-D4Ubqkbq.js","assets/index-ayw0OgPX.js"])))=>i.map(i=>d[i]);
import{g as z,b as s,m as l,c as _,so as c,zU as bt,sm as U,sn as ee,_ as v,sq as Ye,sp as J,aG as K,u as re,b0 as Y,iK as He,zV as ft,ql as wt,dL as Tt,kz as Mt,kA as Lt,ew as Ce,zW as Ct,aU as Je,j_ as $e,nn as Ot,zX as et,zY as tt,zZ as St,z_ as kt,z$ as we,eU as he,A0 as Et,nl as Ne,ch as It,fd as it,dn as $t,b$ as Pt,nk as Vt,j as At,lK as Bt,aP as f,dm as ge,lB as Me,aA as ye,bE as Pe,sr as Ve,au as ot,n as st,P as V,A1 as Fe,z2 as ve,A2 as xt,A3 as Dt,A4 as Rt,td as ze,H as Ht,t3 as Nt,mv as Ft,e_ as zt,aW as Ge}from"./index-CfYeSufM.js";import{l as lt,b as Gt}from"./SketchOptions-_RdOU_mt.js";import{r as We,y as nt,o as de}from"./SketchViewModel-B2klnA_y.js";import{a as Wt,u as Ue,W as Ut,L as Kt,T as jt,v as qt,b as Qt,e as Zt}from"./directionModeIcons-H3VlGLqc.js";import{n as Xt}from"./InteractiveToolBase-XZur83Y0.js";import{p as me}from"./keybindings-CtvTi62R.js";import{o as Yt,r as Jt}from"./drapedUtils-DkjinvLd.js";import{q as rt,t as ei}from"./SnappingManager-uFSx-TIH.js";import{e as ti}from"./vmEvent-D4Ubqkbq.js";import{s as Ke}from"./substitute-o343UI2L.js";let $=class extends z{constructor(e){super(e),this.colorSelection=!0,this.dynamicScaleToggle=!0,this.gridEnabledToggle=!0,this.numericInputs=!0,this.gridSnapEnabledToggle=!0,this.lineIntervalInput=!0,this.outOfScaleWarning=!0,this.placementButtons=!0,this.rotateWithMapToggle=!0}};s([l({type:Boolean,nonNullable:!0})],$.prototype,"colorSelection",void 0),s([l({type:Boolean,nonNullable:!0})],$.prototype,"dynamicScaleToggle",void 0),s([l({type:Boolean,nonNullable:!0})],$.prototype,"gridEnabledToggle",void 0),s([l({type:Boolean,nonNullable:!0})],$.prototype,"numericInputs",void 0),s([l({type:Boolean,nonNullable:!0})],$.prototype,"gridSnapEnabledToggle",void 0),s([l({type:Boolean,nonNullable:!0})],$.prototype,"lineIntervalInput",void 0),s([l({type:Boolean,nonNullable:!0})],$.prototype,"outOfScaleWarning",void 0),s([l({type:Boolean,nonNullable:!0})],$.prototype,"placementButtons",void 0),s([l({type:Boolean,nonNullable:!0})],$.prototype,"rotateWithMapToggle",void 0),$=s([_("esri.widgets.support.GridControls.VisibleElements")],$);const at=$;let P=class extends z{constructor(e){super(e),this.enabledToggle=!0,this.featureEnabledToggle=!0,this.gridEnabledToggle=!0,this.header=!1,this.layerList=!0,this.gridControls=!0,this.gridControlsElements=new at({gridSnapEnabledToggle:!1,gridEnabledToggle:!1}),this.layerListToggleLayersButton=!0,this.selfEnabledToggle=!0}};s([l({type:Boolean,nonNullable:!0})],P.prototype,"enabledToggle",void 0),s([l({type:Boolean,nonNullable:!0})],P.prototype,"featureEnabledToggle",void 0),s([l({type:Boolean,nonNullable:!0})],P.prototype,"gridEnabledToggle",void 0),s([l({type:Boolean,nonNullable:!0})],P.prototype,"header",void 0),s([l({type:Boolean,nonNullable:!0})],P.prototype,"layerList",void 0),s([l({type:Boolean,nonNullable:!0})],P.prototype,"gridControls",void 0),s([l({type:at,nonNullable:!0})],P.prototype,"gridControlsElements",void 0),s([l({type:Boolean,nonNullable:!0})],P.prototype,"layerListToggleLayersButton",void 0),s([l({type:Boolean,nonNullable:!0})],P.prototype,"selfEnabledToggle",void 0),P=s([_("esri.widgets.support.SnappingControls.VisibleElements")],P);const Oe=P;let I=class extends z{constructor(e){super(e),this.point=!0,this.polyline=!0,this.polygon=!0,this.rectangle=!0,this.circle=!0,this.multipoint=!0,this.mesh=!0,this.freehandPolyline=!1,this.freehandPolygon=!1}};s([l({type:Boolean,nonNullable:!0})],I.prototype,"point",void 0),s([l({type:Boolean,nonNullable:!0})],I.prototype,"polyline",void 0),s([l({type:Boolean,nonNullable:!0})],I.prototype,"polygon",void 0),s([l({type:Boolean,nonNullable:!0})],I.prototype,"rectangle",void 0),s([l({type:Boolean,nonNullable:!0})],I.prototype,"circle",void 0),s([l({type:Boolean,nonNullable:!0})],I.prototype,"multipoint",void 0),s([l({type:Boolean,nonNullable:!0})],I.prototype,"mesh",void 0),s([l({type:Boolean,nonNullable:!0})],I.prototype,"freehandPolyline",void 0),s([l({type:Boolean,nonNullable:!0})],I.prototype,"freehandPolygon",void 0),I=s([_("esri.widgets.Sketch.VisibleElements.CreateToolVisibilityMap")],I);let ne=class extends z{constructor(e){super(e),this["rectangle-selection"]=!0,this["lasso-selection"]=!0,this["custom-selection"]=!0}};s([l({nonNullable:!0})],ne.prototype,"rectangle-selection",void 0),s([l({nonNullable:!0})],ne.prototype,"lasso-selection",void 0),s([l({nonNullable:!0})],ne.prototype,"custom-selection",void 0),ne=s([_("esri.widgets.Sketch.VisibleElements.SelectionToolVisibilityMap")],ne);let O=class extends z{constructor(e){super(e),this.createTools=new I,this.directionModePicker=!1,this.duplicateButton=!0,this.deleteButton=!0,this.selectionCountLabel=!0,this.labelsToggle=!0,this.selectionTools=new ne,this.settingsMenu=!0,this.snappingControls=!0,this.snappingControlsElements=new Oe,this.tooltipsToggle=!0,this.undoRedoMenu=!0}};s([l({type:I,nonNullable:!0})],O.prototype,"createTools",void 0),s([l({type:Boolean,nonNullable:!0})],O.prototype,"directionModePicker",void 0),s([l({type:Boolean,nonNullable:!0})],O.prototype,"duplicateButton",void 0),s([l({type:Boolean,nonNullable:!0})],O.prototype,"deleteButton",void 0),s([l({type:Boolean,nonNullable:!0})],O.prototype,"selectionCountLabel",void 0),s([l({type:Boolean,nonNullable:!0})],O.prototype,"labelsToggle",void 0),s([l({type:ne,nonNullable:!0})],O.prototype,"selectionTools",void 0),s([l({type:Boolean,nonNullable:!0})],O.prototype,"settingsMenu",void 0),s([l({type:Boolean,nonNullable:!0})],O.prototype,"snappingControls",void 0),s([l({type:Oe,nonNullable:!0})],O.prototype,"snappingControlsElements",void 0),s([l({type:Boolean,nonNullable:!0})],O.prototype,"tooltipsToggle",void 0),s([l({type:Boolean,nonNullable:!0})],O.prototype,"undoRedoMenu",void 0),O=s([_("esri.widgets.Sketch.VisibleElements")],O);const S={groupSeparator:1,action:{s:32,m:48,l:64},splitButtonPart:{horizontal:{s:16,m:16,l:24},vertical:{s:16,m:24,l:40}}},dt={splitButton:{horizontal:"chevron-down",vertical:"ellipsis"},overflow:"ellipsis"};function ct(t,e){var i;return t.vnodeSelector===e?[t]:((i=t.children)==null?void 0:i.flatMap(o=>ct(o,e)))??[]}const Ae=t=>{let e=class extends t{constructor(){super(...arguments),this.priority=0,this.scale="m",this.slot=void 0,this.lastActiveKey=null,this.layout="horizontal"}destroy(){var i;(i=this.measurementManager)==null||i.managedElements.remove(this),this.measurementManager=null}set measurementManager(i){const o=this._get("measurementManager");i!==o&&(o&&o.managedElements.remove(this),this._set("measurementManager",i),i==null||i.managedElements.add(this))}set budgetedLength(i){this.budgetedLength!==i&&(this._set("budgetedLength",i),this.scheduleRender())}get actionChildren(){var i;return((i=this.children)==null?void 0:i.flatMap(o=>ct(o,"calcite-action")))??[]}get activeChildElement(){var o;const i=this.actionChildren.find(n=>{var r;return((r=n.properties)==null?void 0:r.active)===!0});return i?(this._set("lastActiveKey",(o=i.properties)==null?void 0:o.key),i):this.lastActiveKey?this.actionChildren.find(n=>{var r;return((r=n.properties)==null?void 0:r.key)===this.lastActiveKey}):void 0}_handleClick(i){i!=null&&i.dataset&&"dataset"in i&&i.dataset.actionKey&&(this.lastActiveKey=i.dataset.actionKey)}};return s([l()],e.prototype,"priority",void 0),s([l()],e.prototype,"measurementManager",null),s([l()],e.prototype,"budgetedLength",null),s([l()],e.prototype,"actionChildren",null),s([l()],e.prototype,"activeChildElement",null),s([l()],e.prototype,"scale",void 0),s([l()],e.prototype,"slot",void 0),s([l()],e.prototype,"lastActiveKey",void 0),s([l()],e.prototype,"layout",void 0),e=s([_("esri.widgets.Sketch.support.ResponsiveToolbar.ToolbarGroupBase")],e),e},je=Symbol("on-resize-handle-key");let te=class extends Ae(U){constructor(e){super(e),this._measuredWidth=0,this._measuredHeight=0,this._measuredElement=null}destroy(){this._measuredElement=null}get lengthOptions(){return[this.layout==="horizontal"?this._measuredWidth:this._measuredHeight]}render(){return c("div",{afterCreate:e=>{this._measuredElement=e.firstElementChild,this.addHandles(bt(this._measuredElement,()=>{var i,o;this._measuredWidth=((i=this._measuredElement)==null?void 0:i.clientWidth)??0,this._measuredHeight=((o=this._measuredElement)==null?void 0:o.clientHeight)??0}),je)},afterRemoved:()=>this.removeHandles(je)},this.children)}};s([l()],te.prototype,"_measuredWidth",void 0),s([l()],te.prototype,"_measuredHeight",void 0),s([l()],te.prototype,"lengthOptions",null),s([l()],te.prototype,"_measuredElement",void 0),te=s([_("esri.widgets.Sketch.support.ResponsiveToolbar.MeasuredContentGroup")],te);const ii=te;let q=class extends Ae(U){constructor(e){super(e),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return ee({action:()=>v(()=>import("./index-CfYeSufM.js").then(e=>e.HN),[]),"action-group":()=>v(()=>import("./index-BZXJPhY7.js").then(e=>e.i),__vite__mapDeps([0,1])),"action-menu":()=>v(()=>import("./index-CfYeSufM.js").then(e=>e.HT),[])})}get minimumLength(){const{actionChildren:e,scale:i}=this;return e.length?this.allowCollapse?S.groupSeparator+S.action[i]*Math.min(e.length,2):S.groupSeparator+S.action[i]*e.length:0}get lengthOptions(){const{actionChildren:e,scale:i,minimumLength:o,allowCollapse:n,priority:r}=this,a=[o];if(e.length<=2||!n||r<1)return a;for(let d=1;d<e.length-1;d++)a.push(o+S.action[i]*d);return a}render(){if(!this.actionChildren.length)return c(Ye,null,void 0);const{budgetedLength:e,actionChildren:i,activeChildElement:o,layout:n,slot:r,scale:a}=this,d=Math.floor(e/S.action[a]),u=[],p=[];if(d>=i.length)u.push(...i);else{const h=o??u.at(0);if(u.push(...i.slice(0,d-1)),p.push(...i.slice(d-1)),h&&p.includes(h)){const[b]=p.splice(p.indexOf(h),1),y=u.pop();u.push(b),y&&p.unshift(y)}}return c("calcite-action-group",{key:"overflow-button-group",layout:n,onclick:h=>this._handleClick(h.target),slot:r},u.map(h=>this._renderManagedAction(h)),p.length>0?c("calcite-action-menu",{key:"split-button-dropdown",label:this.messagesCommon.more,overlayPositioning:"fixed"},c("calcite-action",{icon:dt.overflow,key:"split-button-dropdown-trigger",scale:a,slot:"trigger",text:this.messagesCommon.more}),p.map(h=>this._renderManagedAction(h))):void 0)}_renderManagedAction(e){var i,o;return c("calcite-action",{...e==null?void 0:e.properties,"data-action-key":(i=e==null?void 0:e.properties)==null?void 0:i.key,text:((o=e==null?void 0:e.properties)==null?void 0:o.text)??""})}};q.vnodeSelector="calcite-action-group",s([l()],q.prototype,"allowCollapse",void 0),s([l()],q.prototype,"minimumLength",null),s([l(),J("esri/t9n/common")],q.prototype,"messagesCommon",void 0),s([l()],q.prototype,"lengthOptions",null),q=s([_("esri.widgets.Sketch.support.ResponsiveToolbar.OverflowGroup")],q);const oi=q;let Q=class extends z{constructor(){super(...arguments),this.measuredElement=null,this.managedElements=new K,this.availableLength=0,this.layout="horizontal",this._resizeObserver=new ResizeObserver(()=>{this._measure()})}get _sortedElements(){return[...this.managedElements].sort((t,e)=>e.priority-t.priority)}connect(t){this._resizeObserver.disconnect(),this.measuredElement=t,this._resizeObserver.observe(t),this._measure()}allocate(){const t=new Map,{availableLength:e,_sortedElements:i}=this;let o=0;for(const n of i){const r=n.lengthOptions[0];t.set(n,r),o+=r}for(const n of i)for(;o<e;){const r=t.get(n);if(!r)break;const a=n.lengthOptions.find(u=>u>r);if(!a)break;const d=o-r+a;if(d>e)break;t.set(n,a),o=d}for(const[n,r]of t)n.budgetedLength=r}_measure(){const t=this.measuredElement;this.availableLength=t?this.layout==="horizontal"?t.clientWidth??0:t.clientHeight??0:0,this.allocate()}destroy(){this._resizeObserver.disconnect()}};s([l()],Q.prototype,"measuredElement",void 0),s([l()],Q.prototype,"managedElements",void 0),s([l()],Q.prototype,"_sortedElements",null),s([l()],Q.prototype,"availableLength",void 0),s([l()],Q.prototype,"layout",void 0),Q=s([_("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbarManager")],Q);const si=Q,li={splitButtonBase:"esri-split-button--split-part"};let ie=class extends Ae(U){constructor(e){super(e),this.messagesCommon=null}loadDependencies(){return ee({action:()=>v(()=>import("./index-CfYeSufM.js").then(e=>e.HN),[]),"action-group":()=>v(()=>import("./index-BZXJPhY7.js").then(e=>e.i),__vite__mapDeps([0,1])),"action-menu":()=>v(()=>import("./index-CfYeSufM.js").then(e=>e.HT),[])})}get minimumLength(){const e=this.actionChildren;return e.length?e.length===1?S.action[this.scale]+S.groupSeparator:S.action[this.scale]+S.splitButtonPart[this.layout][this.scale]+S.groupSeparator:0}get lengthOptions(){const{actionChildren:e,minimumLength:i,layout:o,scale:n,priority:r}=this;if(e.length<2||r<0)return[i];const a=S.groupSeparator+S.action[n]*e.length;return[S.groupSeparator+S.action[n]+S.splitButtonPart[o][n],a]}render(){if(!this.actionChildren.length)return c(Ye,null,void 0);const{actionChildren:e,minimumLength:i,budgetedLength:o,layout:n,slot:r}=this,a=e.length<2||o>i;return c("calcite-action-group",{key:"split-button-group",layout:n,onclick:d=>this._handleClick(d.target),slot:r},a?this._renderUnSplit():this._renderSplit())}_renderSplit(){const{activeChildElement:e,layout:i,actionChildren:o,scale:n,messagesCommon:r}=this,a=e??o.at(0);if(!a)return;const d=o.filter(u=>u!==a);return[this._renderManagedAction(a),c("calcite-action-menu",{key:"split-button-dropdown",label:r.more,overlayPositioning:"fixed",placement:i==="horizontal"?"bottom-end":"right-end"},c("calcite-action",{class:`${li.splitButtonBase}--${i}--${this.scale}`,compact:i==="horizontal",icon:dt.splitButton[i],key:"split-button-dropdown-trigger",scale:n,slot:"trigger",text:r.more}),d==null?void 0:d.map(u=>this._renderManagedAction(u)))]}_renderUnSplit(){return this.actionChildren.map(e=>this._renderManagedAction(e))}_renderManagedAction(e){var i,o;return c("calcite-action",{...e==null?void 0:e.properties,"data-action-key":(i=e==null?void 0:e.properties)==null?void 0:i.key,text:((o=e==null?void 0:e.properties)==null?void 0:o.text)??""})}};ie.vnodeSelector="calcite-action-group",s([l()],ie.prototype,"minimumLength",null),s([l()],ie.prototype,"lengthOptions",null),s([l(),J("esri/t9n/common")],ie.prototype,"messagesCommon",void 0),ie=s([_("esri.widgets.Sketch.support.ResponsiveToolbar.SplitButton")],ie);const A="esri-responsive-toolbar",B={rulerBase:`${A}__ruler`,rulerBarHorizontal:`${A}__ruler--bar`,rulerBarVertical:`${A}__ruler--bar--vertical`,rulerPadVertical:`${A}__ruler--pad--vertical`,rulerPadHorizontal:`${A}__ruler--pad--horizontal`,bar:`${A}__bar`,barHorizontal:`${A}__bar--horizontal`,barVertical:`${A}__bar--vertical`,pad:`${A}__pad`,padVertical:`${A}__pad--vertical`,padHorizontal:`${A}__pad--horizontal`};let Z=class extends U{constructor(e){super(e),this.scale="m",this.barStyle="floating",this._measurementManager=new si,this._managedWidgets=new Map}loadDependencies(){return ee({"action-bar":()=>v(()=>import("./index-CFKgBu5P.js"),__vite__mapDeps([2,1,0,3])),"action-pad":()=>v(()=>import("./index-f57OK8O5.js"),__vite__mapDeps([4,1,0,3]))})}destroy(){this._measurementManager=re(this._measurementManager),this._managedWidgets.forEach(e=>e.destroy()),this._managedWidgets.clear()}set layout(e){const i=this._get("layout");this._set("layout",e),this._measurementManager&&(this._measurementManager.layout=e),i!==e&&this.scheduleRender()}render(){const{layout:e,scale:i,barStyle:o}=this,n={layout:e,scale:i,expandDisabled:!0,key:"measured-toolbar"},r=o==="docked"?e==="vertical"?B.rulerBarVertical:B.rulerBarHorizontal:e==="horizontal"?B.rulerPadHorizontal:B.rulerPadVertical;return c("div",null,c("div",{afterCreate:a=>{var d;(d=this._measurementManager)==null||d.connect(a)},class:this.classes(B.rulerBase,r)}),o==="docked"?c("calcite-action-bar",{...n,classes:{[B.barHorizontal]:this.layout==="horizontal",[B.barVertical]:this.layout==="vertical",[B.bar]:!0},overflowActionsDisabled:!0},this._renderChildren()):c("calcite-action-pad",{...n,class:this.classes(B.pad,e==="horizontal"?B.padHorizontal:B.padVertical)},this._renderChildren()))}_renderChildren(){var n;if(!this.children)return;const e=this.children.filter(r=>{var a;return((a=r.properties)==null?void 0:a.key)!==void 0&&"group-kind"in r.properties}),i=new Set,o=e.map(r=>{const a=r.properties,d=a.key;i.add(d);const u=this.barStyle==="docked"?a.slot??void 0:void 0,p=a.priority??0,h=a["group-kind"]??"overflow-group",b=a["allow-collapse"]??!0,y=this._managedWidgets.get(d);if(y)return y.children=r.children,y.priority=p,"allowCollapse"in y&&(y.allowCollapse=b),y.slot=u,y.layout=this.layout,y.scale=this.scale,y.measurementManager=this._measurementManager,y;const w={scale:this.scale,priority:p,measurementManager:this._measurementManager,children:r.children,slot:u,layout:this.layout};switch(h){case"split-button":{const M=new ie({...w});return this._managedWidgets.set(d,M),M}case"overflow-group":{const M=new oi({...w,allowCollapse:b});return this._managedWidgets.set(d,M),M}case"measured-content":{const M=new ii({...w});return this._managedWidgets.set(d,M),M}}}).filter(Y);return Array.from(this._managedWidgets.keys()).filter(r=>!i.has(r)).forEach(r=>{var a;(a=this._managedWidgets.get(r))==null||a.destroy(),this._managedWidgets.delete(r)}),(n=this._measurementManager)==null||n.allocate(),o.map(r=>r.render())}};s([l()],Z.prototype,"scale",void 0),s([l({value:"horizontal"})],Z.prototype,"layout",null),s([l()],Z.prototype,"barStyle",void 0),s([l()],Z.prototype,"_measurementManager",void 0),s([l()],Z.prototype,"_managedWidgets",void 0),Z=s([_("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbar")],Z);const qe=Z;let k=class extends z{constructor(e){super(e),this.coordinates=void 0,this.strokeDash=[],this.strokeWidth=1,this.strokeColor=[0,0,0,1],this.strokeDashColor=[255,255,255,1],this.fillColor=[0,0,0,0],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){const e=this.strokeColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _strokeBackgroundStyle(){const e=this.strokeDashColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _fillStyle(){const e=this.fillColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _renderCoordinates(){const e=[];if(!this.coordinates)return{coordinates:e,rect:He};const i=ft(wt(Tt(He),this.coordinates),2*this.strokeWidth);i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]+.5),i[3]=Math.ceil(i[3]+.5);for(const o of this.coordinates)e.push([Math.floor(o[0]-i[0])+.5,Math.floor(o[1]-i[1])+.5]);return e.reverse(),{coordinates:e,rect:i}}render(){const{coordinates:e,rect:i}=this._renderCoordinates,o=Mt(i),n=Lt(i);return c("div",{classes:{"esri-outline-overlay-item":!0},styles:{left:i[0]+"px",top:i[1]+"px",width:o+"px",height:n+"px",visibility:this.visible?"visible":"hidden"}},c("svg",{height:n,styles:{display:"block"},width:o},c("polygon",{fill:this._fillStyle,points:e.map(([r,a])=>`${r},${a}`).join(" "),stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),c("polygon",{fill:"transparent",points:e.map(([r,a])=>`${r},${a}`).join(" "),stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.length?this.strokeDash.join(" "):void 0,"stroke-width":this.strokeWidth})))}renderCanvas(){}};s([l()],k.prototype,"coordinates",void 0),s([l()],k.prototype,"strokeDash",void 0),s([l()],k.prototype,"strokeWidth",void 0),s([l()],k.prototype,"strokeColor",void 0),s([l()],k.prototype,"strokeDashColor",void 0),s([l()],k.prototype,"fillColor",void 0),s([l()],k.prototype,"visible",void 0),s([l()],k.prototype,"isDecoration",void 0),s([l({readOnly:!0})],k.prototype,"_strokeStyle",null),s([l({readOnly:!0})],k.prototype,"_strokeBackgroundStyle",null),s([l({readOnly:!0})],k.prototype,"_fillStyle",null),s([l({readOnly:!0})],k.prototype,"_renderCoordinates",null),k=s([_("esri.views.overlay.OutlineOverlayItem")],k);const ni=k;let E=class extends Ce.EventedMixin(Xt){constructor(e){super(e),this._overlayItem=void 0,this.geometryType=null,this.mode=null,this.type="draw-screen"}initialize(){this.drawOperation=this._makeDrawOperation();const e=i=>this.drawOperation.on(i,o=>{this._updateVisuals(),this.emit(i,o)});this.addHandles([e("vertex-add"),e("vertex-remove"),e("vertex-update"),e("cursor-update"),e("complete")]),this.finishToolCreation()}destroy(){this.drawOperation=re(this.drawOperation),this._set("view",null)}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centeredToggled(e){this._set("centeredToggled",e),this._updateVisuals()}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}set uniformSizeToggled(e){this._set("uniformSizeToggled",e),this._updateVisuals()}get updating(){var e;return((e=this.drawOperation)==null?void 0:e.updating)??!1}get cursor(){return this.geometryType==="point"?"default":"crosshair"}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(e){this.destroyed||this.drawOperation.onInputEvent(e)}redo(){this.drawOperation.redo()}undo(){this.drawOperation.undo()}reset(){}_makeDrawOperation(){const{view:e}=this;return new Wt({view:e,manipulators:this.manipulators,geometryType:ri(this.geometryType),drawingMode:this.mode,hasZ:!1,defaultZ:0,snapToSceneEnabled:!1,drawSurface:new Ue,hasM:!1,snappingManager:null,snappingVisualizer:null,graphic:null,cursor:this.cursor})}get coordinates(){var a,d,u;const{drawOperation:e}=this;if(!(e!=null&&e.geometryIncludingUncommittedVertices.length))return[];const{coordinateHelper:i}=e,o=e.committableVertex,n=e.committedVertices.slice();o!=null&&n.push(i.pointToArray(o));const r=n.length;switch(this.geometryType){case"circle":case"rectangle":{const p=new Ut(Ct,Ue.spatialReference),h=this.geometryType==="circle"?Kt:jt,b=this.geometryType==="circle"?qt:Qt;if(r===1&&e.isCompleted){const y=n[0],w=p.makeMapPoint(y[0]+ai,y[1]);return((a=h([y,w],p,!0))==null?void 0:a.geometry.rings[0])??[]}if(r===2){const y=this.geometryType!=="rectangle",w=this.centeredToggled!==y,M=this.geometryType!=="rectangle";return(this.uniformSizeToggled!==M?(d=h(n,p,w))==null?void 0:d.geometry.rings[0]:(u=b(n,p,w))==null?void 0:u.geometry.rings[0])??[]}return[]}}return n}_updateVisuals(){var e;if(!this._overlayItem){const i=new ni({strokeDash:[5],strokeDashColor:[255,255,255,255]});(e=this.view.overlay)==null||e.addItem(i),this.addHandles(Je(()=>{var o;(o=this.view.overlay)==null||o.removeItem(i),i==null||i.destroy(),this._overlayItem=void 0})),this._overlayItem=i}this._overlayItem.coordinates=this.coordinates}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}};function ri(t){switch(t){case"polygon":case"point":return t;case"circle":case"rectangle":return"segment"}}s([l({value:!1})],E.prototype,"centeredToggled",null),s([l()],E.prototype,"drawOperation",void 0),s([l({value:!0})],E.prototype,"enabled",null),s([l({value:!1})],E.prototype,"uniformSizeToggled",null),s([l({constructOnly:!0})],E.prototype,"geometryType",void 0),s([l({constructOnly:!0})],E.prototype,"mode",void 0),s([l({readOnly:!0})],E.prototype,"type",void 0),s([l({readOnly:!0})],E.prototype,"updating",null),s([l({constructOnly:!0,nonNullable:!0})],E.prototype,"view",void 0),s([l()],E.prototype,"cursor",null),E=s([_("esri.views.draw.DrawScreenTool")],E);const ai=48;async function di(){return v(()=>import("./geometryEngineJSON-Bvf5zUh7.js").then(t=>t.g),__vite__mapDeps([5,6,7,8]))}async function ci(){return di().then(({contains:t,intersects:e,overlaps:i,simplify:o})=>({contains:t,intersects:e,overlaps:i,simplify:o}))}async function pi(t){const{currentSelection:e,selector:i,signal:o,sources:n,view:r}=t;if(!(n!=null&&n.length))return{added:[],removed:[]};const{layers:a,layerViews:d,graphicsLayers:u}=yi(n),p=(await $e(Promise.all([hi(i,a,r,o),gi(i,d,r,o),ui(i,u,r)]),o)).flat();if(!e)return{added:p,removed:[]};const h=e.toArray(),b=p.filter(w=>!Qe(h,w)),y=h.filter(w=>!Qe(p,w));return e.removeMany(y),e.addMany(b),{added:b,removed:y}}const ui=async(t,e,i)=>bi({candidates:e.flatMap(o=>o.graphics.toArray())??[],selector:t,view:i}),hi=async(t,e,i,o)=>{const n=await he(mi({selector:t,signal:o,layers:e,view:i}));return n?pt(n):[]},gi=async(t,e,i,o)=>{const n=await he(vi({selector:t,signal:o,layerViews:e,view:i}));return n?pt(n):[]};function pt(t){const e=[];for(let i=0;i<t.length;i++){const o=t[i];o.status==="fulfilled"&&e.push(...o.value)}return e}function yi(t){const e=[],i=[],o=[];return t.forEach(n=>{var r,a;Ot(n)?e.push(n):(et(n)||tt(n))&&((r=n.layers)!=null&&r.length)?e.push(...n.layers.toArray()):St(n)&&((a=n.sublayers)!=null&&a.length)?o.push(...n.sublayers.toArray()):kt(n)?o.push(n):we(n)&&i.push(n)}),{layers:e,layerViews:i,graphicsLayers:o}}function Qe(t,e){if(t.includes(e))return!0;const i=e.getObjectId(),o=i!=null,{layer:n,uid:r}=e;return o?t.some(a=>{if(n===a.layer)return i===a.getObjectId()}):t.some(a=>{if(n===a.layer)return r===a.uid})}async function vi(t){const{layerViews:e,selector:i,signal:o,view:n}=t;return $e(Promise.allSettled(e.map(async r=>{const a=r.createQuery(),{geometry:d}=ut(i,r.layer,n);return a.outFields=["*"],a.geometry=d,a.returnGeometry=!0,a.outSpatialReference=n.spatialReference,r.queryFeatures(a,{signal:o}).then(({features:u})=>u)})),o)}async function mi(t){const{layers:e,selector:i,signal:o,view:n}=t;return $e(Promise.allSettled(e.map(async r=>r.queryFeatures(_i(r.createQuery(),i,r,n),{signal:o}).then(({features:a})=>a))),o)}function ut(t,e,i){var u;const o="renderer"in e?Yt({renderer:e.renderer}):0,n=t.type==="point"?Jt(t,o,i):t,r="displayField"in e?e.displayField:null,a=Et({displayField:r,fields:e.fields}),d=[e.objectIdField];if(a!=null&&e.fieldsIndex.has(a)&&d.push(a),"globalIdField"in e&&e.globalIdField!=null&&e.fieldsIndex.has(e.globalIdField)&&d.push(e.fieldsIndex.get(e.globalIdField).name),Ne(e)&&e.subtypeField!=null&&e.fieldsIndex.has(e.subtypeField)&&d.push(e.fieldsIndex.get(e.subtypeField).name),"utilityNetworks"in i.map&&((u=i.map.utilityNetworks)!=null&&u.length)&&(Ne(e)||e.type==="feature")){const p=e.fieldsIndex.get("assetgroup"),h=e.fieldsIndex.get("assettype");p!=null&&p.name&&d.push(p.name),h!=null&&h.name&&d.push(h.name)}return{geometry:n,outFields:d}}function _i(t,e,i,o){const{outFields:n,geometry:r}=ut(e,i,o);return t.outFields=n,t.geometry=r,t.returnGeometry=!0,t.outSpatialReference=o.spatialReference,t}async function bi(t){const{selector:e,candidates:i,view:o}=t;if(!(i!=null&&i.length)||!e)return[];const{spatialReference:n}=o,r=e,a=await ci();return i.filter(d=>d.geometry&&d.geometry.type!=="mesh"&&a.intersects(n,r,d.geometry))}const fi=100;let oe=class extends Ce.EventedAccessor{constructor(e){super(e),this._processTask=null,this.options=null,this.selection=new K,this.sources=null,this._process=It(async(i,o)=>{const{callback:n,selector:r,completed:a}=i,d=it(async u=>{var w;const{options:p,sources:h,selection:b,view:y}=this;if(!(!(h!=null&&h.length)&&!(y!=null&&y.selectionManager.sources.length))&&y){if(r&&h!=null){const M=await pi({currentSelection:b,selector:r,signal:u,sources:h,view:y});a&&(p==null?void 0:p.persistSelection)!==!1&&((w=y.selectionManager)==null||w.updateSelection({current:b.toArray(),...M}))}n&&n()}else b.removeAll()});return $t(o,()=>d.abort()),this._processTask=d,d.promise},fi)}initialize(){this._setup()}cancel(){var e;this.removeAllHandles(),(e=this._processTask)==null||e.abort()}async _setup(){const{view:e}=this;if(await e.whenReady(),this.destroyed)return;const i=this.options,o=(i==null?void 0:i.createTool)??"rectangle",n=(i==null?void 0:i.mode)??(o==="polygon"?"click":"hybrid"),r=Symbol();this._tool=new E({view:e,mode:n,geometryType:o}),i!=null&&i.selectOnComplete||this.addHandles(this._tool.on(["cursor-update","vertex-add","vertex-remove"],()=>he(this._process({selector:this._selectionArea}))),r),this.addHandles([e.on("key-down",a=>{if(!a.repeat)switch(a.key){case me.constraint:this._tool.uniformSizeToggled=!0,a.stopPropagation();break;case me.center:this._tool.centeredToggled=!0,a.stopPropagation()}}),e.on("key-up",a=>{switch(a.key){case me.constraint:this._tool.uniformSizeToggled=!1,a.stopPropagation();break;case me.center:this._tool.centeredToggled=!1,a.stopPropagation()}}),this._tool.on("complete",async a=>{this.removeHandles(r);const d=()=>{this.removeAllHandles(),this.emit("complete",{aborted:a.aborted,selection:this.selection.toArray()})};a.aborted?(this.cancel(),this.selection.removeAll(),d()):await this._process({selector:this._selectionArea,callback:d,completed:!0})})],r),this.addHandles(Je(()=>e.tools.remove(this._tool))),e.addAndActivateTool(this._tool)}get _selectionArea(){const e=Bt(),i=this._tool.coordinates,o=this.view.spatialReference,n=a=>{e.x=a[0],e.y=a[1];const{x:d,y:u}=this.view.toMap(e);return[d,u]};if(i.length===0)return;if(i.length===1||i.every(([a,d])=>a===i[0][0]&&d===i[0][1])){const[a,d]=n(i[0]);return new Pt({x:a,y:d,spatialReference:o})}const r=i.map(n);if(r.length!==0)return Vt(r)||r.reverse(),new At({spatialReference:o,rings:[r]})}};s([l()],oe.prototype,"options",void 0),s([l({readOnly:!0})],oe.prototype,"selection",void 0),s([l()],oe.prototype,"sources",void 0),s([l({constructOnly:!0})],oe.prototype,"view",void 0),oe=s([_("esri.widgets.support.Selector2D.SelectionOperation")],oe);const wi=oe;let H=class extends Ce.EventedAccessor{constructor(e){super(e),this._operationHandlesGroup=null,this.activeOperation=null,this.layerViewPreferenceEnabled=!0,this.sources=null}initialize(){this.addHandles([f(()=>this._sources,e=>{this.activeOperation&&(this.activeOperation.sources=e)})])}destroy(){this._operationHandlesGroup=ge(this._operationHandlesGroup)}get _sources(){const{layerViewPreferenceEnabled:e,sources:i,view:o}=this;return o&&(i!=null&&i.length)?i.flatMap(n=>{if(we(n))return n;if(et(n)||tt(n)){const a=n.layers||[],d=a.map(u=>{const p=We(o,u)||void 0;return e&&we(p)?p:u});return d.length?d.toArray():a.length?a.toArray():n}if(!e)return n;const r=We(o,n)||void 0;return we(r)?r:n}):[]}get layers(){return Me(ye.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources}set layers(e){Me(ye.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources=e}get state(){const{_sources:e,view:i}=this,o=!(e!=null&&e.length)&&!(i!=null&&i.selectionManager.sources.length);return this.activeOperation?"active":i!=null&&i.ready&&!o?"ready":"disabled"}cancel(){var e;this.state==="active"&&((e=this.activeOperation)==null||e.cancel(),this._set("activeOperation",null))}activate(e){const{_sources:i,state:o,view:n}=this,r=!(i!=null&&i.length)&&!(n!=null&&n.selectionManager.sources.length);if(o==="disabled"||r||!this.view)return;o==="active"&&this.cancel();const a=new wi({view:this.view,sources:i,options:e});return this._operationHandlesGroup=Pe([a.selection.on("change",d=>this.emit("selection-change",d)),a.once("complete",d=>this._onOperationComplete(d))]),this._set("activeOperation",a),a}_onOperationComplete(e){this._operationHandlesGroup=ge(this._operationHandlesGroup),this._set("activeOperation",null),this.emit("complete",e)}};s([l()],H.prototype,"_sources",null),s([l({readOnly:!0})],H.prototype,"activeOperation",void 0),s([l()],H.prototype,"layers",null),s([l()],H.prototype,"layerViewPreferenceEnabled",void 0),s([l()],H.prototype,"sources",void 0),s([l({readOnly:!0})],H.prototype,"state",null),s([l()],H.prototype,"view",void 0),H=s([_("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],H);const Ti=H,Ze={lassoTool:!0,rectangleTool:!0},Se="esri-selection-toolbar",ke={base:Se,container:`${Se}__container`,toolButton:`${Se}__tool-button`};let T=class extends U{constructor(t,e){super(t,e),this._viewModelHandlesGroup=null,this.activeToolInfo=null,this.defaultLassoToolOptions={createTool:"polygon",mode:"freehand"},this.defaultRectangleToolOptions={createTool:"rectangle"},this.messages=null,this.toolConfigs=[],this.viewModel=new Ti,this.visibleElements={...Ze},this.scale="s",this.layout="horizontal",this._viewModelHandlesGroup=Pe([this.viewModel.on("complete",i=>{this._set("activeToolInfo",null),this.emit("complete",i)})])}destroy(){this._viewModelHandlesGroup=ge(this._viewModelHandlesGroup)}loadDependencies(){return ee({action:()=>v(()=>import("./index-CfYeSufM.js").then(t=>t.HN),[])})}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get layers(){return Me(ye.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources}set layers(t){Me(ye.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources=t}get layerViewPreferenceEnabled(){return this.viewModel.layerViewPreferenceEnabled}set layerViewPreferenceEnabled(t){this.viewModel.layerViewPreferenceEnabled=t}get sources(){return this.viewModel.sources}set sources(t){this.viewModel.sources=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}castVisibleElements(t){return{...Ze,...t}}get state(){return this.viewModel.state}get visibleToolCount(){const{view:t,toolConfigs:e,visibleElements:i}=this;return((e==null?void 0:e.length)??0)+((t==null?void 0:t.type)==="2d"?(i.lassoTool?1:0)+(i.rectangleTool?1:0):0)}activate(t){if(this.cancel(),this.state!=="disabled")switch(t){case"lasso":this._activateTool("lasso");break;case"rectangle":this._activateTool("rectangle");break;default:this._activateTool(t)}}cancel(){this.viewModel.cancel(),this._set("activeToolInfo",null)}render(){return c("div",{"aria-label":this.label,class:this.classes(ke.base,Ve.widget)},c("div",{class:ke.container},this._renderDefaultTools(),this._renderCustomTools()))}_renderDefaultTools(){var t;if(((t=this.view)==null?void 0:t.type)==="2d")return[this._renderRectangleTool(),this._renderLassoTool()]}_renderCustomTools(){var t;if((t=this.toolConfigs)!=null&&t.length)return this.toolConfigs.map(({toolName:e,icon:i,toolKey:o})=>this._renderToolWithTooltip(e,o,i))}_renderLassoTool(){const{messages:t,visibleElements:e}=this;if(!e.lassoTool)return;const i=t.selectByLasso;return this._renderToolWithTooltip("lasso","lasso","lasso-select",i)}_renderRectangleTool(){const{messages:t,visibleElements:e}=this;if(!e.rectangleTool)return;const i=t.selectByRectangle;return this._renderToolWithTooltip("rectangle","rectangle","cursor-marquee",i)}_renderToolWithTooltip(t,e,i,o=t){var r;const n=`${this.id}-tool-${e}`;return c("calcite-action",{active:((r=this.activeToolInfo)==null?void 0:r.toolName)===t,bind:this,class:ke.toolButton,disabled:this.state==="disabled",icon:i||"selection",id:n,key:n,onclick:()=>this._toggleTool(t),scale:this.scale,text:o,title:o})}_activateTool(t){const e=this._getToolOptions(t);if(!e)return;const i=this.viewModel.activate(e);i&&this._set("activeToolInfo",{toolName:t,operation:i})}_toggleTool(t){if(this.activeToolInfo){const e=this.activeToolInfo.toolName;if(this.cancel(),e===t)return}this._activateTool(t)}_getToolOptions(t){return t==="lasso"?this.defaultLassoToolOptions:t==="rectangle"?this.defaultRectangleToolOptions:this.toolConfigs.find(e=>e.toolName===t)}};s([l({readOnly:!0})],T.prototype,"activeToolInfo",void 0),s([l()],T.prototype,"defaultLassoToolOptions",void 0),s([l()],T.prototype,"defaultRectangleToolOptions",void 0),s([l()],T.prototype,"label",null),s([l()],T.prototype,"layers",null),s([l()],T.prototype,"layerViewPreferenceEnabled",null),s([l(),J("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],T.prototype,"messages",void 0),s([l()],T.prototype,"sources",null),s([l()],T.prototype,"toolConfigs",void 0),s([l()],T.prototype,"view",null),s([l()],T.prototype,"viewModel",void 0),s([l()],T.prototype,"visibleElements",void 0),s([ot("visibleElements")],T.prototype,"castVisibleElements",null),s([l()],T.prototype,"scale",void 0),s([l()],T.prototype,"state",null),s([l()],T.prototype,"layout",void 0),s([l()],T.prototype,"visibleToolCount",null),T=s([_("esri.widgets.support.SelectionToolbar")],T);const Mi=T,ht=()=>ee({icon:()=>v(()=>import("./index-CfYeSufM.js").then(t=>t.HH),[]),label:()=>v(()=>import("./index-Brmf-FJp.js"),__vite__mapDeps([9,1])),switch:()=>v(()=>import("./index-5A6Q9Ymv.js"),__vite__mapDeps([10,1])),tooltip:()=>v(()=>import("./index-DlQs6GcF.js"),__vite__mapDeps([11,1]))}),ce="esri-labeled-switch",pe={label:`${ce}__label`,labelContent:`${ce}__label-content`,iconInfo:`${ce}__icon_info`,iconWarning:`${ce}__icon_warning`,tooltip:`${ce}__tooltip`};function ae({checked:t,disabled:e,hint:i,key:o,label:n,onChange:r,hintIcon:a,hintKind:d}){return c("calcite-label",{class:pe.label,disabled:e,key:o,layout:"inline-space-between",scale:"s"},i?c("div",{class:pe.labelContent,key:"label-content"},c("div",null,n),c("calcite-icon",{class:d!=="warning"?pe.iconInfo:pe.iconWarning,icon:a??"information",id:o,scale:"s",tabIndex:0}),c("calcite-tooltip",{class:pe.tooltip,overlayPositioning:"fixed",referenceElement:o},i)):n,c("calcite-switch",{checked:t,disabled:e,scale:"s",onCalciteSwitchChange:u=>r(u.currentTarget.checked)}))}let se=class extends z{constructor(e){super(e),this.directionModePicker=!1,this.header=!1,this.labelsToggle=!0,this.tooltipsToggle=!0}};s([l({type:Boolean,nonNullable:!0})],se.prototype,"directionModePicker",void 0),s([l({type:Boolean,nonNullable:!0})],se.prototype,"header",void 0),s([l({type:Boolean,nonNullable:!0})],se.prototype,"labelsToggle",void 0),s([l({type:Boolean,nonNullable:!0})],se.prototype,"tooltipsToggle",void 0),se=s([_("esri.widgets.support.SketchTooltipControls.VisibleElements")],se);const Be=se,_e="esri-sketch-tooltip-controls",be={base:_e,block:`${_e}__block`,blockContent:`${_e}__block-content`,radioButtonLabelWrapper:`${_e}__radio-button-label-wrapper`};let X=class extends U{constructor(e,i){super(e,i),this.viewModel=null,this.visibleElements=new Be,this.sketchOptions=new lt,this.viewType=void 0,this._onTooltipsEnabledChange=o=>{this.sketchOptions.tooltips.enabled=o},this._onLabelsEnabledChange=o=>{this.sketchOptions.labels.enabled=o},this._onDirectionModeChange=o=>{this.sketchOptions.values.directionMode=o.currentTarget.selectedItem.value}}loadDependencies(){return Promise.all([ee({block:()=>v(()=>import("./index-Dua-T4iP.js"),__vite__mapDeps([12,1])),label:()=>v(()=>import("./index-Brmf-FJp.js"),__vite__mapDeps([9,1])),icon:()=>v(()=>import("./index-CfYeSufM.js").then(e=>e.HH),[]),"radio-button":()=>v(()=>import("./index-DSKdqVJd.js"),__vite__mapDeps([13,1])),"radio-button-group":()=>v(()=>import("./index-HnPKUUfx.js"),__vite__mapDeps([14,1]))}),ht()])}render(){const{label:e,visibleElements:i}=this,o=this._renderContent();return c("div",{"aria-label":e,class:this.classes(be.base,Ve.widget)},o?c("calcite-block",{class:be.block,heading:i.header?this.label:"",key:"content-block",label:this.label,open:!0},c("div",{class:be.blockContent,key:"content"},o)):void 0)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}_renderContent(){const{visibleElements:e,viewType:i}=this,o=[e.tooltipsToggle?this._renderTooltipsToggle():null,e.labelsToggle&&i!=="2d"?this._renderLabelsToggle():null,e.directionModePicker?this._renderDirectionModePicker():null].filter(Y);return o.length===0?null:o}_renderTooltipsToggle(){const{messages:e,sketchOptions:i}=this;return c(ae,{checked:i.tooltips.effectiveEnabled,hint:e.tooltipsToggleHint,key:`${this.id}__tooltips`,label:e.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const{messages:e,sketchOptions:i}=this;return c(ae,{checked:i.labels.enabled,hint:e.labelsToggleHint,key:`${this.id}__labels`,label:e.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){const{messages:e,sketchOptions:i}=this,{directionMode:o}=i.values;return c("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},e.directionModePicker,c("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:o,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",o,e.directionModeRelative),this._renderDirectionModeOption("absolute",o,e.directionModeAbsolute)))}_renderDirectionModeOption(e,i,o){return c("calcite-label",{key:e,layout:"inline",scale:"s"},c("calcite-radio-button",{checked:e===i,scale:"s",value:e}),c("div",{class:be.radioButtonLabelWrapper,key:"label-wrapper"},c("calcite-icon",{icon:Zt[e],scale:"s"}),o))}};s([l()],X.prototype,"label",null),s([l({type:Be,nonNullable:!0})],X.prototype,"visibleElements",void 0),s([l(),J("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],X.prototype,"messages",void 0),s([l({nonNullable:!0,type:lt})],X.prototype,"sketchOptions",void 0),s([l({type:String})],X.prototype,"viewType",void 0),X=s([_("esri.widgets.support.SketchTooltipControls")],X);const Li=X,Ci={hide:"hide"};function Le(t){return(t==null?void 0:t.listMode)??void 0}function Oi(t){return t!=null&&"minScale"in t&&t.minScale!=null?t.minScale:void 0}function Si(t){return t!=null&&"maxScale"in t&&t.maxScale!=null?t.maxScale:void 0}function ki(t){if(!t)return"inherited";const e=Ii(yt(t)?t.layer:t);return e!=null?e?"independent":"inherited":"visibilityMode"in t&&t.visibilityMode!=null?t.visibilityMode:"independent"}function gt(t){if(t&&(!("type"in t)||t.type!=="wmts"))return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function xe(t){return Le(t)!==Ci.hide}function Ei(t,e){if(!t||e==null||isNaN(e))return!1;const i=Oi(t),o=Si(t),n=i!=null&&!isNaN(i)&&i>0&&e>i,r=o!=null&&!isNaN(o)&&o>0&&e<o;return n||r}function Xe(t){const e=t==null?void 0:t.layer;return e&&"layers"in e?e.layers:null}function yt(t){return t!=null&&"layer"in t&&t.layer!=null}function Ii(t){const e=$i(t);return e!=null&&"supportsSublayerVisibility"in e?e.supportsSublayerVisibility:void 0}function $i(t){return t&&"capabilities"in t&&t.capabilities!=null&&"exportMap"in t.capabilities?t.capabilities.exportMap:void 0}let C=class extends st.IdentifiableMixin(U){constructor(e,i){super(e,i),this._legend=null,this.className=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([f(()=>this._canCreateLegend,()=>this._createLegend(),V),f(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),V)])}destroy(){this._legend=re(this._legend)}get _canCreateLegend(){const{content:e,listItem:i}=this;if(!i)return!1;const o="legend";return e===o||e!=null&&!!Array.isArray(e)&&e.includes(o)}get _legendOptions(){const{listItem:e,_legendLayerInfo:i}=this,o=e==null?void 0:e.view;return i&&o?{view:o,layerInfos:[i]}:{}}get _legendLayerInfo(){var a;const e=(a=this.listItem)==null?void 0:a.layer;if(!e||e.type==="subtype-sublayer")return null;const i=yt(e)?e:null,o=e==null?void 0:e.parent,n=o!=null&&"type"in o&&o.type==="map-image"?i==null?void 0:i.source:null,r="";return n&&o?{layer:o,title:r,sublayerIds:[n.mapLayerId]}:{layer:e,title:r}}get disabled(){var n;const{listItem:e,_legend:i,content:o}=this;return!e||!(Array.isArray(o)&&o.length>1)&&!!i&&(!((n=i.activeLayerInfos)!=null&&n.length)||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){const{image:e}=this,i=this._getFirstWidget();return this._get("icon")??(!e&&i?i.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){var e;return this._get("title")||(((e=this._getFirstWidget())==null?void 0:e.label)??"")}set title(e){this._override("title",e)}render(){return c("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){const{_legend:i,disabled:o,open:n}=this;return e&&!o&&n?e==="legend"&&i?c("div",{key:"legend-widget"},i.render()):typeof e=="string"?c("div",{innerHTML:e,key:e}):Fe(e)?c("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?c("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){const{content:e,open:i}=this;return i?Array.isArray(e)?e.map(o=>this._renderContent(o)):this._renderContent(e):null}async _createLegend(){if(re(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:e}=await v(()=>import("./Legend-Ce1JJ1sy.js"),__vite__mapDeps([15,1,16,17,18,19,20,21,22,23,24,25,26,27,28,29])),i=new e(this._legendOptions);this._legend=i}_attachToNode(e){e.appendChild(this)}_updateLegend(){const e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return e==="legend"?this._legend:Fe(e)?e:null}_getFirstWidget(){const{content:e}=this;return Array.isArray(e)?e.map(i=>this._getWidget(i)).find(i=>i):this._getWidget(e)}};s([l()],C.prototype,"_legend",void 0),s([l()],C.prototype,"_canCreateLegend",null),s([l()],C.prototype,"_legendOptions",null),s([l()],C.prototype,"_legendLayerInfo",null),s([l()],C.prototype,"className",void 0),s([l()],C.prototype,"content",void 0),s([l()],C.prototype,"disabled",null),s([l()],C.prototype,"flowEnabled",void 0),s([l()],C.prototype,"icon",null),s([l()],C.prototype,"image",void 0),s([l()],C.prototype,"listItem",void 0),s([l()],C.prototype,"open",void 0),s([l()],C.prototype,"title",null),s([l()],C.prototype,"visible",void 0),C=s([_("esri.widgets.LayerList.ListItemPanel")],C);const vt=C;var ue;const Pi=K.ofType({key:"type",defaultKeyValue:"button",base:Rt,typeMap:{button:Dt,toggle:xt}}),mt=K.ofType(Pi),Ee="layer",fe="child-list-mode",Vi="hide";let m=ue=class extends st.IdentifiableMixin(z){constructor(t){super(t),this.actionsSections=new mt,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(K.ofType(ue)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.panel=null,this.parent=null,this.view=null}initialize(){if(this.addHandles([f(()=>{var t;return[this.layer,(t=this.layer)==null?void 0:t.listMode,this.listModeDisabled]},()=>this._watchLayerProperties(this.layer),V),f(()=>this.checkPublishStatusEnabled,t=>this._updateChildrenPublishing(t),V),f(()=>this.view,t=>this._updateChildrenView(t),V),f(()=>this.panel,t=>this._setListItemOnPanel(t),V)]),typeof this.listItemCreatedFunction=="function"){const t={item:this};this.listItemCreatedFunction.call(null,t)}}destroy(){var t;(t=this.panel)==null||t.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:t,publishing:e}=this;if(!e&&t&&"connectionStatus"in t)return t.connectionStatus}get error(){var t;return(t=this.layer)==null?void 0:t.loadError}get incompatible(){const{layerView:t}=this;return!(!t||!("spatialReferenceSupported"in t))&&!t.spatialReferenceSupported}get layerView(){const{layer:t,view:e}=this;if(!t||!e||t.type==="sublayer")return null;const i=t.type==="subtype-sublayer"?t.parent:t;return e.allLayerViews.find(o=>o.layer===i)??null}castPanel(t){var e;return(e=this.panel)!=null&&e.open&&!t.hasOwnProperty("open")&&(t.open=!0),t?new vt(t):null}get sortable(){var t;return((t=this.layer)==null?void 0:t.type)!=="knowledge-graph-sublayer"&&this._get("sortable")}set sortable(t){this._set("sortable",t)}get title(){const t=ve(this,"layer.layer");return(!t||t&&ve(this,"layer.layer.loaded"))&&ve(this,"layer.title")||ve(this,"layer.attributes.title")||""}set title(t){this._override("title",t)}get publishing(){var i;const{layer:t,checkPublishStatusEnabled:e}=this;return!!(e&&t&&"publishingInfo"in t&&((i=t.publishingInfo)==null?void 0:i.status)==="publishing")}get updating(){const{layerView:t,connectionStatus:e,layer:i,publishing:o}=this;return!o&&!e&&(t?t.updating:(i==null?void 0:i.loadStatus)==="loading"||!1)}get visible(){var t;return!!((t=this.layer)!=null&&t.visible)}set visible(t){const e=this.layer;e&&(e.visible=t)}get visibleAtCurrentScale(){var t,e;return((t=this.layerView)==null?void 0:t.visibleAtCurrentScale)??!Ei(this.layer,(e=this.view)==null?void 0:e.scale)}get visibleAtCurrentTimeExtent(){var t;return((t=this.layerView)==null?void 0:t.visibleAtCurrentTimeExtent)??!0}get visibilityMode(){return ki(this.layer)}clone(){return new ue({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(t){t&&(t.listItem=this)}_updateChildrenPublishing(t){var e;(e=this.children)==null||e.forEach(i=>i.checkPublishStatusEnabled=t)}_updateChildrenView(t){const e=this.children;e&&e.forEach(i=>i.view=t)}_createChildren(t){const{listModeDisabled:e,children:i}=this,o=t.filter(n=>!i.some(r=>r.layer===n));i.addMany(this._createChildItems(o,e))}_destroyChildren(t){const{children:e}=this,i=e.filter(o=>!!o.layer&&!t.includes(o.layer));e.destroyMany(i)}_sortChildren(t){this.children.sort((e,i)=>t.indexOf(i.layer)-t.indexOf(e.layer))}_destroyAllChildren(){this.removeHandles(fe),this.children.destroyAll()}_watchChildLayerListMode(t){this.removeHandles(fe),this.listModeDisabled||this.addHandles(t.toArray().map(e=>f(()=>e.listMode,()=>this._compileChildren(t))),fe)}_compileChildren(t){const e=this.listModeDisabled?t:t==null?void 0:t.filter(i=>Le(i)!==Vi);t!=null&&t.length?(this._createChildren(e),this._destroyChildren(e),this._sortChildren(e),this._watchChildLayerListMode(t)):this._destroyAllChildren()}_watchSublayerChanges(t){t&&this.addHandles(t.on("change",()=>this._compileChildren(t)),Ee)}_initializeChildLayers(t){this._compileChildren(t),this._watchSublayerChanges(t)}_createChildItems(t,e){return t.reverse().map(i=>e||xe(i)?new ue({layer:i,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(Y)}_watchLayerProperties(t){if(this.removeHandles(Ee),this.removeHandles(fe),!t)return;if((!this.listModeDisabled&&Le(t))==="hide-children")return void this.children.destroyAll();const e=gt(t);e&&this.addHandles(f(()=>t[e],i=>{t.hasOwnProperty(e)&&this._initializeChildLayers(i)},V),Ee)}};s([l({type:mt})],m.prototype,"actionsSections",void 0),s([l()],m.prototype,"actionsOpen",void 0),s([l()],m.prototype,"checkPublishStatusEnabled",void 0),s([l({type:K.ofType(m)})],m.prototype,"children",void 0),s([l()],m.prototype,"childrenSortable",void 0),s([l({readOnly:!0})],m.prototype,"connectionStatus",null),s([l({readOnly:!0})],m.prototype,"error",null),s([l()],m.prototype,"hidden",void 0),s([l({readOnly:!0})],m.prototype,"incompatible",null),s([l()],m.prototype,"layer",void 0),s([l({readOnly:!0})],m.prototype,"layerView",null),s([l()],m.prototype,"listItemCreatedFunction",void 0),s([l({nonNullable:!0})],m.prototype,"listModeDisabled",void 0),s([l()],m.prototype,"open",void 0),s([l({type:vt})],m.prototype,"panel",void 0),s([ot("panel")],m.prototype,"castPanel",null),s([l()],m.prototype,"parent",void 0),s([l({value:!0})],m.prototype,"sortable",null),s([l()],m.prototype,"title",null),s([l({readOnly:!0})],m.prototype,"publishing",null),s([l({readOnly:!0})],m.prototype,"updating",null),s([l()],m.prototype,"view",void 0),s([l()],m.prototype,"visible",null),s([l({readOnly:!0})],m.prototype,"visibleAtCurrentScale",null),s([l({readOnly:!0})],m.prototype,"visibleAtCurrentTimeExtent",null),s([l({readOnly:!0})],m.prototype,"visibilityMode",null),m=ue=s([_("esri.widgets.LayerList.ListItem")],m);const De=m,x={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},Ai="hide",_t=K.ofType(De);let N=class extends Ce.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new _t,this.view=null}initialize(){this.addHandles([f(()=>{var e;return((e=this.view)==null?void 0:e.ready)===!0},()=>this._viewHandles(),V),f(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList()),f(()=>ze(this.view)?this.view.inGeographicLayout:null,()=>this._compileList())],x.view)}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:e}=this;return e!=null&&e.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(e=>e.children).length}triggerAction(e,i){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:i})}moveListItem(e,i,o,n){var w,M;const r=e==null?void 0:e.layer;if(!r||r.type==="subtype-sublayer"||r.type==="sublayer")return;const a=(M=(w=this.view)==null?void 0:w.map)==null?void 0:M.layers,d=i?Xe(i):a,u=o?Xe(o):a;if(!d||!u)return;const{operationalItems:p}=this,h=(i==null?void 0:i.children)||p,b=(o==null?void 0:o.children)||p,y=u.length-n;e.parent=o||null,h.remove(e),d.remove(r),b.includes(e)||b.add(e,y),u.includes(r)||u.add(r,y),this._compileList()}_createLayerViewHandles(e){this.removeHandles(x.layerViews),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),x.layerViews)}_createMapLayerHandles(e){this.removeHandles(x.mapLayers),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),x.mapLayers)}_createListItem(e){const{view:i,listItemCreatedFunction:o,checkPublishStatusEnabled:n,listModeDisabled:r}=this;return new De({checkPublishStatusEnabled:n,listModeDisabled:r,layer:e,listItemCreatedFunction:o,view:i})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(i=>Le(i)!==Ai):void 0}_watchLayersListMode(e){this.removeHandles(x.layerListMode),e&&!this.listModeDisabled&&this.addHandles(f(()=>e.filter(i=>"listMode"in i).map(i=>i.listMode).toArray(),()=>this._compileList()),x.layerListMode)}_compileList(){var n,r;const e=(r=(n=this.view)==null?void 0:n.map)==null?void 0:r.layers,i=ze(this.view)&&!this.view.inGeographicLayout?e==null?void 0:e.filter(({type:a})=>a==="link-chart"):e;this._watchLayersListMode(i);const o=this._getViewableLayers(i);o!=null&&o.length?(this._createNewItems(o),this._removeItems(o),this._sortItems(o)):this._removeAllItems()}_createNewItems(e){const{operationalItems:i}=this;e.forEach(o=>{i.some(n=>n.layer===o)||i.add(this._createListItem(o))})}_removeItems(e){const{operationalItems:i}=this,o=[];i.forEach(n=>{n&&e&&e.includes(n.layer)||o.push(n)}),i.destroyMany(o)}_sortItems(e){const{operationalItems:i}=this;i.sort((o,n)=>{const r=e.indexOf(o.layer),a=e.indexOf(n.layer);return r>a?-1:r<a?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([x.mapLayers,x.layerViews,x.viewLayers]),e!=null&&e.ready?this.addHandles([f(()=>{var i,o;return(o=(i=this.view)==null?void 0:i.map)==null?void 0:o.allLayers},i=>this._createMapLayerHandles(i),V),f(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},i=>this._createLayerViewHandles(i),V)],x.viewLayers):this._removeAllItems()}};s([l()],N.prototype,"checkPublishStatusEnabled",void 0),s([l()],N.prototype,"listItemCreatedFunction",void 0),s([l({nonNullable:!0})],N.prototype,"listModeDisabled",void 0),s([l({type:_t})],N.prototype,"operationalItems",void 0),s([l({readOnly:!0})],N.prototype,"state",null),s([l()],N.prototype,"totalItems",null),s([l()],N.prototype,"view",void 0),N=s([_("esri.widgets.LayerList.LayerListViewModel")],N);const Bi=N,Re=t=>xi(t)||Di(t),xi=t=>{if(!("type"in t))return!1;switch(t.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":case"subtype-sublayer":return!0;default:return!1}},Di=t=>{const e=gt(t);if(e!=null&&t.hasOwnProperty(e)&&t[e]!=null){for(const i of t[e])if(Re(i))return!0}return!1},Te=(t,e)=>e!=null&&t!=null&&(e.test(t.title)?"self":!!t.children.some(i=>Te(i,e)!==!1)&&"children");var Ie;let W=Ie=class extends De{constructor(t){super(t),this.children=new K,this.parent=null}get enabled(){const{children:t}=this;if(t.length===0)return this.featureSource!=null&&this.featureSource.enabled?"enabled":"disabled";let e=!1,i=!1;for(const o of t){if(o.enabled==="indeterminate")return o.enabled;if(o.enabled==="enabled"?e=!0:o.enabled==="disabled"&&(i=!0),i&&e)return"indeterminate"}return i?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap(t=>{var e;return[(e=t.layer)==null?void 0:e.id,...t.childLayerIds]})}get featureSource(){const{layer:t,getFeatureSnappingSources:e}=this;return e().find(i=>i.layer===t)}_initializeChildLayers(t){if(!t)return;const e=t.filter(Re);super._initializeChildLayers(e)}_createChildItems(t){return t.map(e=>xe(e)?new Ie({layer:e,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(Y).reverse()}};s([l()],W.prototype,"enabled",null),s([l()],W.prototype,"children",void 0),s([l()],W.prototype,"childLayerIds",null),s([l()],W.prototype,"featureSource",null),s([l({constructOnly:!0})],W.prototype,"getFeatureSnappingSources",void 0),s([l()],W.prototype,"parent",void 0),W=Ie=s([_("esri.widgets.support.SnappingControls.SnappingListItem")],W);let le=class extends Bi{constructor(){super(...arguments),this.featureSnappingSources=new K}get operationalItemsFlat(){return this.operationalItems.flatten(t=>t.children)}get selectableItems(){return this.operationalItemsFlat.filter(t=>{var e;return!((e=t.children)!=null&&e.length)})}_compileList(){var o,n;const t=(n=(o=this.view)==null?void 0:o.map)==null?void 0:n.layers;if(!t)return;const e=t.filter(Re);this._watchLayersListMode(e);const i=this._getViewableLayers(e);i!=null&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createListItem(t){return new W({layer:t,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};s([l()],le.prototype,"featureSnappingSources",void 0),s([l()],le.prototype,"operationalItems",void 0),s([l()],le.prototype,"operationalItemsFlat",null),s([l()],le.prototype,"selectableItems",null),le=s([_("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],le);let F=class extends z{constructor(t){super(t),this.layerListViewModel=new le,this.snappingOptions=new rt,this.view=null}initialize(){this.addHandles([f(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:t,view:e})=>{t.view=e},V),f(()=>{var t;return{viewModel:this.layerListViewModel,sources:(t=this.snappingOptions)==null?void 0:t.featureSources}},({viewModel:t,sources:e})=>{t.featureSnappingSources=e},V)])}get allLayersEnabled(){var t;return(((t=this.layerListViewModel)==null?void 0:t.selectableItems)??[]).every(e=>e.enabled==="enabled")}get allLayersDisabled(){var t;return(((t=this.layerListViewModel)==null?void 0:t.selectableItems)??[]).every(e=>!e.enabled)}get layersEnabledCount(){var t,e;return((e=(t=this.layerListViewModel)==null?void 0:t.selectableItems)==null?void 0:e.filter(i=>i.enabled==="enabled").length)??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(t,e){t==null||t.forEach(i=>e?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i))}toggleSnappingForAllLayers(t){this.layerListViewModel.selectableItems.forEach(({layer:e})=>{const i=e==null?void 0:e.id;t?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i)})}enableSnappingForLayer(t){const e=this._findSnappingSourceForLayer(t)??this._makeSnappingSourceForLayer(t);e&&(e.enabled=!0)}disableSnappingForLayer(t){const e=this._findSnappingSourceForLayer(t);e&&(e.enabled=!1)}updateEnabledFeatureSources(t){for(const e of this.snappingOptions.featureSources)xe(e.layer)&&(e.enabled=t.includes(e.layer.id))}_findSnappingSourceForLayer(t){return this.snappingOptions.featureSources.find(e=>e.layer.id===t)}_makeSnappingSourceForLayer(t){var o;const e=(o=this.layerListViewModel.operationalItemsFlat.find(n=>{var r;return((r=n.layer)==null?void 0:r.id)===t}))==null?void 0:o.layer;if(!e)throw new Ht("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${t} because no such layer was found in the view`);if(e.type==="group")return;const i=new ei({layer:e});return this.snappingOptions.featureSources.add(i),i}};s([l()],F.prototype,"allLayersEnabled",null),s([l()],F.prototype,"allLayersDisabled",null),s([l({constructOnly:!0})],F.prototype,"layerListViewModel",void 0),s([l()],F.prototype,"layersEnabledCount",null),s([l({type:rt,nonNullable:!0})],F.prototype,"snappingOptions",void 0),s([l()],F.prototype,"state",null),s([l()],F.prototype,"view",void 0),F=s([_("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],F);const Ri=F,R="esri-snapping-controls",D={base:R,container:`${R}__container`,toggleBlock:`${R}__toggle-block`,layerListBlock:`${R}__layer-list-block`,layerList:`${R}__layer-list`,layerListFilter:`${R}__layer-list__filter`,layerListButton:`${R}__layer-list__button`,layerListItem:`${R}__layer-list__item`,layerListGroup:`${R}__layer-list__group`,nestedContainer:`${R}__nested-container`};let L=class extends U{constructor(t,e){super(t,e),this._defaultViewModel=null,this._layerListFilter=null,this._gridLoadTask=null,this.layerListOpen=!0,this.gridOptionsOpen=!1,this.messages=null,this.messagesCommon=null,this.snappingManager=null,this.visibleElements=new Oe,this._enableSnappingSwitchChange=r=>{this.snappingOptions.enabled=r},this._featureEnabledSwitchChange=r=>{this.snappingOptions.featureEnabled=r},this._gridEnabledSwitchChange=r=>{this.snappingOptions.gridEnabled=r,r&&this._startLoadGrid()},this._selfEnabledSwitchChange=r=>{this.snappingOptions.selfEnabled=r},this._onToggleLayersButtonClick=r=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),Nt(r.target)};const{snappingOptions:i,view:o,viewModel:n}=t;this.viewModel=n??(this._defaultViewModel=new Ri({snappingOptions:i,view:o}))}normalizeCtorArgs(t){const{snappingOptions:e,view:i,viewModel:o,...n}=t;return n}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=re(this._defaultViewModel))}loadDependencies(){return Promise.all([ee({block:()=>v(()=>import("./index-Dua-T4iP.js"),__vite__mapDeps([12,1])),button:()=>v(()=>import("./index-CfYeSufM.js").then(t=>t.HI),[]),input:()=>v(()=>import("./index-CfYeSufM.js").then(t=>t.HK),[]),list:()=>v(()=>import("./index-CfYeSufM.js").then(t=>t.HL),[]),"list-item":()=>v(()=>import("./index-CfYeSufM.js").then(t=>t.HQ),[]),checkbox:()=>v(()=>import("./index-DDVACUeq.js"),__vite__mapDeps([30,1])),loader:()=>v(()=>import("./index-CfYeSufM.js").then(t=>t.HG),[])}),ht()])}initialize(){this.addHandles(f(()=>{var t;return((t=this.view)==null?void 0:t.type)==="2d"&&!!this.view.grid},t=>{this.visibleElements.gridControls&&(this.snappingOptions.gridEnabled=t)}))}get _openAndReady(){return this.gridOptionsOpen&&this.snappingOptions.gridEnabled&&this.snappingOptions.enabled}get icon(){return"snap-to-point"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(t){this.viewModel.snappingOptions=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}set viewModel(t){t!==this._get("viewModel")&&(this._defaultViewModel!=null&&this._defaultViewModel===t||(this._defaultViewModel=re(this._defaultViewModel)),this._set("viewModel",t))}render(){const{label:t}=this;return c("div",{"aria-label":t,class:this.classes(D.base,Ve.widget)},c("div",{class:D.container},this._renderContent()))}_renderContent(){var t;return[this._renderToggles(),this._renderLayerList(),((t=this.view)==null?void 0:t.type)==="2d"&&this.visibleElements.gridControls?this._renderGridOptions():null]}_renderToggles(){const{visibleElements:t,view:e}=this,i=[t.selfEnabledToggle?this._renderSelfEnabledToggle():null,t.featureEnabledToggle?this._renderFeatureEnabledToggle():null,t.gridEnabledToggle&&(e==null?void 0:e.type)==="2d"?this._renderGridEnabledToggle():null].filter(Y),o=[t.enabledToggle?this._renderEnabledToggle():null,i.length>0?c("div",{class:D.nestedContainer},i):null].filter(Y);return o.length===0?null:c("calcite-block",{class:D.toggleBlock,heading:t.header?this.label:"",key:"toggle-block",label:this.label,open:!0},o)}_renderEnabledToggle(){return c(ae,{checked:this.viewModel.snappingOptions.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:this.messages.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){return c(ae,{checked:this.viewModel.snappingOptions.selfEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:this.messages.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){return c(ae,{checked:this.viewModel.snappingOptions.featureEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,label:this.messages.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderGridEnabledToggle(){return c(ae,{checked:this.viewModel.snappingOptions.gridEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__grid-enabled-toggle`,label:this.messages.grid,onChange:this._gridEnabledSwitchChange})}_renderLayerList(){var a;if(!this.visibleElements.layerList)return null;const{messages:t,viewModel:e}=this,i=e.layerListViewModel.operationalItems.length>9?c("calcite-input",{class:D.layerListFilter,clearable:!0,placeholder:t==null?void 0:t.searchLayers,onCalciteInputInput:({currentTarget:{value:d}})=>{this._layerListFilter=d===""?null:new RegExp(d,"i")}}):null,o=this._secondaryElementsDisabled,n=this.layerListOpen&&!o,r=(a=e.layerListViewModel.operationalItems)==null?void 0:a.find(d=>!!d.children.length);return c("calcite-block",{class:D.layerListBlock,collapsible:!0,disabled:this._secondaryElementsDisabled,heading:t.snappingLayers,key:"list-block",open:n,onCalciteBlockToggle:d=>this.layerListOpen=d.currentTarget.open},i,this._renderToggleLayersButton(),c("calcite-list",{class:D.layerList,displayMode:r?"nested":"flat",label:t==null?void 0:t.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(e.layerListViewModel.operationalItems)))}_renderGridOptions(){var p;const{view:t,visibleElements:e,snappingManager:i,snappingOptions:o,_openAndReady:n}=this,{gridEnabled:r,enabled:a}=o;(n||(t==null?void 0:t.type)==="2d"&&t.grid)&&this._startLoadGrid();const d=(p=this._gridLoadTask)==null?void 0:p.value,u=d&&(t==null?void 0:t.type)==="2d"&&c(d,{snappingManager:i,snappingOptions:o,view:t,visibleElements:e.gridControlsElements});return c("calcite-block",{class:D.layerListBlock,collapsible:!0,disabled:!r||!a,heading:this.messages.gridOptionsHeading,key:"grid-block",open:n,onCalciteBlockClose:()=>this.gridOptionsOpen=!1,onCalciteBlockOpen:()=>this.gridOptionsOpen=!0},u??c("calcite-loader",{label:this.messagesCommon.loading,scale:"s",text:this.messagesCommon.loading}))}async _startLoadGrid(){var t;!this._gridLoadTask&&this.visibleElements.gridControls&&((t=this.view)==null?void 0:t.type)==="2d"&&(this._gridLoadTask=it(async()=>(await v(async()=>{const{default:e}=await import("./GridControls-_d27-0p8.js");return{default:e}},__vite__mapDeps([31,1,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,6,7,57,58,59,60,61,62,23,63,64,65,66,67,29,68,69]))).default))}_renderLayerListItemCollection(t){const e=this._layerListFilter;return t.map(i=>{switch(e?Te(i,e):null){case"children":{const o=i.children.filter(n=>Te(n,e)!==!1);return this._renderLayerListItemGroup(i,o)}case"self":case null:return this._renderLayerListItemOrGroup(i);case!1:return Te(i.parent,e)==="self"?this._renderLayerListItemOrGroup(i):null}}).toArray().filter(Y)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const{viewModel:{allLayersEnabled:t},messages:e}=this,i=t?e.disableAllLayers:e.enableAllLayers;return c("calcite-button",{appearance:"transparent",class:D.layerListButton,label:i,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},i)}_renderLayerListItemOrGroup(t){if(t.children.length)return this._renderLayerListItemGroup(t);const{messages:{untitledLayer:e}}=this,i=t.title||e,o=()=>{var n;this.viewModel.toggleSnappingForLayers([(n=t.layer)==null?void 0:n.id],t.enabled!=="enabled")};return c("calcite-list-item",{class:D.layerListItem,key:`${this.id}-list-item-${t.uid}`,label:i,onCalciteListItemSelect:n=>{n.stopPropagation(),o()}},c("calcite-checkbox",{checked:t.enabled==="enabled",slot:"actions-start",onCalciteCheckboxChange:o}))}_renderLayerListItemGroup(t,e){const{messages:i}=this,{children:o,title:n}=t,r=n||i.untitledLayer,a=n&&n!==""?n:Ft(),d=!!(e!=null&&e.length),u=e??o,p=()=>{this.viewModel.toggleSnappingForLayers(t.childLayerIds,t.enabled!=="enabled")},h=u==null?void 0:u.find(b=>!!b.children.length);return c("calcite-list-item",{class:D.layerListGroup,key:a,label:r,open:d,onCalciteListItemSelect:b=>{b.stopPropagation(),p()}},c("calcite-checkbox",{checked:t.enabled==="enabled",indeterminate:t.enabled==="indeterminate",slot:"actions-start",onCalciteCheckboxChange:p}),c("calcite-list",{displayMode:h?"nested":"flat",label:i==null?void 0:i.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(u)))}get _enabledToggleDisabled(){const t=this.snappingOptions;return t.enabledToggled||t.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};s([l()],L.prototype,"_defaultViewModel",void 0),s([l()],L.prototype,"_layerListFilter",void 0),s([l()],L.prototype,"_gridLoadTask",void 0),s([l()],L.prototype,"_openAndReady",null),s([l()],L.prototype,"label",null),s([l({type:Boolean,nonNullable:!0})],L.prototype,"layerListOpen",void 0),s([l({type:Boolean,nonNullable:!0})],L.prototype,"gridOptionsOpen",void 0),s([l(),J("esri/widgets/support/SnappingControls/t9n/SnappingControls")],L.prototype,"messages",void 0),s([l(),J("esri/t9n/common")],L.prototype,"messagesCommon",void 0),s([l()],L.prototype,"snappingOptions",null),s([l()],L.prototype,"snappingManager",void 0),s([l()],L.prototype,"view",null),s([l()],L.prototype,"viewModel",null),s([l({type:Oe,nonNullable:!0})],L.prototype,"visibleElements",void 0),s([l()],L.prototype,"_enabledToggleDisabled",null),s([l()],L.prototype,"_secondaryElementsDisabled",null),L=s([_("esri.widgets.support.SnappingControls")],L);const Hi=L,j="esri-sketch",G={base:j,vertical:`${j}--vertical`,docked:`${j}-bar`,floating:`${j}-pad`,chipHorizontal:`${j}__selection-count-chip--horizontal`,chipVertical:`${j}__selection-count-chip--vertical`,chipVerticalSmall:`${j}__selection-count-chip--vertical--s`,popoverWrapper:`${j}__popover-wrapper`},Ni={point:"pin",polyline:"line",polygon:"polygon",rectangle:"rectangle",circle:"circle",multipoint:"pins",mesh:"i3-d-building",freehandPolygon:"freehand-area",freehandPolyline:"freehand"};let g=class extends U{constructor(t,e){super(t,e),this._activeCustomToolOptions=null,this._selectionToolbar=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.customToolOptions=null,this.customActions=null,this.toolbarKind="floating",this.contextualToolLocation="separate",this.groupCollapsePriorities=null,this.messages=null,this.messagesCommon=null,this.visibleElements=new O,this._defaultViewModel=null,this._calcitePopoverReferenceElement=null,this._relativeLocation="top",this._popoverOpen=!1,this._activateCreateTool=this._activateCreateTool.bind(this),this.viewModel=(t==null?void 0:t.viewModel)||(this._defaultViewModel=new nt({creationMode:(t==null?void 0:t.creationMode)??"continuous"}))}initialize(){const{layer:t,view:e}=this,i=new Mi({view:(e==null?void 0:e.type)==="2d"?e:null,sources:t?[t]:null,scale:this.scale});this.addHandles([f(()=>this.viewModel,o=>{this._viewModelHandlesGroup=ge(this._viewModelHandlesGroup),o&&(this._viewModelHandlesGroup=Pe([o.on("create",()=>this.scheduleRender()),o.on("update",()=>this.scheduleRender()),o.on("delete",n=>this.emit("delete",n)),o.on("undo",()=>this.scheduleRender()),o.on("redo",()=>this.scheduleRender()),f(()=>o.layer,n=>{this._selectionToolbar&&(this._selectionToolbar.sources=n?[n]:null)}),f(()=>o.view,n=>{this._selectionToolbar&&(this._selectionToolbar.view=(n==null?void 0:n.type)==="2d"?n:null)}),f(()=>o.state,()=>this.notifyChange("state"))]))},Ge),zt(()=>i.activeToolInfo,()=>this.viewModel.cancel()),i.on("complete",o=>this._onSelectionOperationComplete(o)),f(()=>{const{selectionTools:o}=this.visibleElements;return{lassoTool:!!(o!=null&&o["lasso-selection"]),rectangleTool:!!(o!=null&&o["rectangle-selection"])}},o=>{Object.assign(i.visibleElements,o)},Ge)]),this._selectionToolbar=i}loadDependencies(){return ee({action:()=>v(()=>import("./index-CfYeSufM.js").then(t=>t.HN),[]),chip:()=>v(()=>import("./index-ayw0OgPX.js"),__vite__mapDeps([70,1])),popover:()=>v(()=>import("./index-CfYeSufM.js").then(t=>t.HS),[])})}destroy(){var t;(t=this._selectionToolbar)==null||t.destroy(),this._viewModelHandlesGroup=ge(this._viewModelHandlesGroup)}get activeTool(){var n;const t=(n=this._selectionToolbar)==null?void 0:n.activeToolInfo;if(t)switch(t.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}const e=this._effectiveAvailableCreateTools,{activeTool:i,activeCreateToolDrawMode:o}=this.viewModel;return i==="polygon"&&o==="freehand"&&(e!=null&&e.includes("freehandPolygon"))?"freehandPolygon":i==="polyline"&&o==="freehand"&&(e!=null&&e.includes("freehandPolyline"))?"freehandPolyline":this.viewModel.activeTool}get activeTooltip(){return this.viewModel.activeTooltip}get createGraphic(){return this.viewModel.createGraphic}get creationMode(){return this.viewModel.creationMode}set creationMode(t){this.viewModel.creationMode=t}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(t){this.viewModel.defaultCreateOptions=t}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(t){this.viewModel.defaultUpdateOptions=t}get icon(){return"pencil"}set icon(t){this._overrideIfSome("icon",t)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(t){this.viewModel.labelOptions=t}get layer(){return this.viewModel.layer}set layer(t){this.viewModel.layer=t}set layout(t){this._set("layout",t),this._selectionToolbar&&(this._selectionToolbar.layout=t)}set scale(t){this._set("scale",t),this._selectionToolbar&&(this._selectionToolbar.scale=t)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(t){this.viewModel.snappingOptions=t}get state(){var t;return(t=this._selectionToolbar)!=null&&t.activeToolInfo?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(t){this.viewModel.tooltipOptions=t}get updateGraphics(){return this.viewModel.updateGraphics}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(t){this.viewModel.valueOptions=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}set viewModel(t){const e=this._get("viewModel");t!==e&&(e&&e===this._defaultViewModel&&re(e),this._set("viewModel",t))}get _effectiveAvailableCreateTools(){const{availableCreateTools:t,view:e,visibleElements:i}=this,o=t==null?void 0:t.filter(n=>{var r;return!!((r=i.createTools)!=null&&r[n])});return(e==null?void 0:e.type)==="3d"?o==null?void 0:o.filter(n=>n!=="multipoint"):o}create(t,e,i){const o=(i==null?void 0:i.createOptions)??e;return this._activeCustomToolOptions=i,he(this.viewModel.create(t,o))}update(t,e){return he(this.viewModel.update(t,e))}complete(){this.viewModel.complete()}cancel(){var t;(t=this._selectionToolbar)==null||t.cancel(),this.viewModel.cancel(),this._activeCustomToolOptions=null}undo(){var t;this.viewModel.undo(),(t=this.view)==null||t.focus()}redo(){var t;this.viewModel.redo(),(t=this.view)==null||t.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}dismissFloatingElements(){this._popoverOpen=!1}render(){var n,r,a;const{toolbarKind:t,layout:e,scale:i}=this,o=(n=this.customActions)==null?void 0:n.filter(d=>d.position==="selection-toolbar");return c("div",null,c("div",{classes:{[G.base]:!0,[G.floating]:t==="floating",[G.docked]:t==="docked",[G.vertical]:e==="vertical"}},c(qe,{barStyle:t,layout:e,scale:i},this._renderSelectionSetItemGroupInline(),c("div",{"group-kind":"split-button",key:"selection-split-button",priority:((r=this.groupCollapsePriorities)==null?void 0:r.get("selectionTools"))??de.Low},this._renderDefaultSelectionButton(),(a=this._selectionToolbar)==null?void 0:a.render(),o==null?void 0:o.map(d=>this._renderToolbarItem(d))),this._renderCreateToolActionGroup(),this._renderUndoRedoMenuItemGroup(),this._renderSettingsMenuItemGroup()),this._renderSelectionSetToolbar(),this._renderSettingsMenuPopover()))}_renderSettingsMenuPopover(){const{messagesCommon:t,snappingOptions:e,view:i,viewModel:o,visibleElements:n}=this;if(!this._calcitePopoverReferenceElement)return;const r={directionModePicker:n.directionModePicker,labelsToggle:n.labelsToggle,tooltipsToggle:n.tooltipsToggle},a=this.layout==="horizontal"?this._relativeLocation==="top"?"bottom-end":"top-end":"right-end";return c("calcite-popover",{closable:!0,focusTrapDisabled:!0,heading:t.settings,label:t.settings,open:this._popoverOpen,overlayPositioning:"fixed",placement:a,referenceElement:this._calcitePopoverReferenceElement,scale:this.scale,onCalcitePopoverBeforeClose:()=>this._popoverOpen=!1,onCalcitePopoverBeforeOpen:d=>this._remeasurePopoverSizes(d.currentTarget),onCalcitePopoverClose:()=>this._refocusOnView()},c("div",{class:G.popoverWrapper},Object.values(r).includes(!0)?c(Li,{sketchOptions:o.sketchOptions,viewType:i==null?void 0:i.type,visibleElements:new Be(r)}):void 0,n.snappingControls&&i&&e?c(Hi,{snappingManager:this.viewModel.snappingManager,snappingOptions:e,view:i,visibleElements:n.snappingControlsElements}):void 0))}_renderSelectionSetToolbar(){if(this.contextualToolLocation!=="separate")return;const t=this._renderSelectionSetItemGroup();return t!=null&&t.length?c(qe,{barStyle:this.toolbarKind,layout:this.layout,scale:this.scale},t):void 0}_renderSelectionSetItemGroupInline(){return this.contextualToolLocation==="separate"?[]:this._renderSelectionSetItemGroup()}_renderUndoRedoMenuItemGroup(){var t;return c("div",{"group-kind":"split-button",key:"undo-redo-menu",priority:((t=this.groupCollapsePriorities)==null?void 0:t.get("undoRedo"))??de.Medium,slot:"actions-end"},this._renderUndoButton(),this._renderRedoButton())}_renderSettingsMenuItemGroup(){var o,n;const t=[],e=[];(o=this.customActions)==null||o.forEach(r=>{r.position==="settings-before"?e.push(r):r.position==="settings-after"&&t.push(r)});const i=[...e.map(r=>this._renderToolbarItem(r)),this._renderSettingsMenuButton(),...t.map(r=>this._renderToolbarItem(r))].filter(Y);if(i.length)return c("div",{"allow-collapse":!1,"group-kind":"overflow-group",key:"settings-menu",priority:((n=this.groupCollapsePriorities)==null?void 0:n.get("settings"))??de.Max,slot:"actions-end"},i)}_renderSelectionSetItemGroup(){var n,r,a;if(!this.updateGraphics.length)return[];const t=this.contextualToolLocation==="inline-end"?"actions-end":void 0,e=(n=this.customActions)==null?void 0:n.filter(d=>d.position==="before-selection-set"),i=(r=this.customActions)==null?void 0:r.filter(d=>d.position==="after-selection-set"),o=((a=this.groupCollapsePriorities)==null?void 0:a.get("selectionSet"))??de.High;return[c("div",{"group-kind":"measured-content",key:"selection-count-chip-group",priority:o,slot:t},this._renderFeatureCountChip()),c("div",{"allow-collapse":!1,"group-kind":"overflow-group",key:"selection-set-tool-group",priority:o,slot:t},e==null?void 0:e.map(d=>this._renderToolbarItem(d)),this._renderDuplicateButton(),this._renderDeleteButton(),i==null?void 0:i.map(d=>this._renderToolbarItem(d)))]}_renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return[];const{messages:t,state:e}=this;return this._renderToolbarItem({id:"pointer-select",text:t.selectFeature,icon:"cursor",onclick:this._activateDefaultSelectTool,active:e==="ready"})}_renderCreateToolActionGroup(){var i,o,n;const t=((i=this._effectiveAvailableCreateTools)==null?void 0:i.flatMap(r=>this._renderBuiltInCreateToolItem(r)))??[],e=((o=this.customToolOptions)==null?void 0:o.flatMap(r=>this._renderCustomToolItem(r)))??[];return c("div",{"group-kind":"overflow-group",key:"create-tools-group",priority:((n=this.groupCollapsePriorities)==null?void 0:n.get("createTools"))??de.High},t,e)}_renderBuiltInCreateToolItem(t){return this._renderToolbarItem({id:`${t}-button`,text:this.messages.draw[t],icon:Ni[t],onclick:()=>this._activateCreateTool(t),active:this.activeTool===t&&!this._activeCustomToolOptions})}_renderCustomToolItem(t){var i;const{toolKey:e}=t;return this._renderToolbarItem({id:`custom-${t.toolKey}`,text:t.label,icon:t.icon,onclick:()=>this._activateCreateTool(t.toolName,null,t),active:((i=this._activeCustomToolOptions)==null?void 0:i.toolKey)===e})}_renderUndoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"undo-button",text:this.messages.undo,icon:"undo",disabled:!this.viewModel.canUndo(),onclick:this.undo,flipRTL:!0}):[]}_renderRedoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"redo-button",text:this.messages.redo,icon:"redo",disabled:!this.viewModel.canRedo(),onclick:this.redo,flipRTL:!0}):[]}_renderSettingsMenuButton(){return this.visibleElements.settingsMenu?this._renderToolbarItem({id:"settings-menu-action",text:this.messagesCommon.settings,icon:"gear",active:this._popoverOpen,onclick:()=>this._popoverOpen=!this._popoverOpen,afterCreate:t=>this._calcitePopoverReferenceElement=t,afterUpdate:t=>this._calcitePopoverReferenceElement=t,afterRemoved:()=>this._calcitePopoverReferenceElement=null}):[]}_renderFeatureCountChip(){if(!this.visibleElements.selectionCountLabel)return[];const{layout:t,messages:e,scale:i,id:o,updateGraphics:{length:n}}=this,r=Ke(e.selectedCount,{count:n}),a=i==="s"?99:999,d=n>a?Ke(e.selectedCountTruncated,{truncated:a}):n,u=i==="s"&&t==="vertical",p=u?`${o}-selection-chip-small`:`${o}-selection-chip`;return[u?c("span",{classes:{[G.chipVertical]:!0,[G.chipVerticalSmall]:this.scale==="s"},id:p,tabIndex:0,title:r},d):c("calcite-chip",{appearance:"outline",class:t==="horizontal"?G.chipHorizontal:G.chipVertical,id:p,kind:"brand",label:r,scale:i==="l"?"m":"s",tabIndex:0,title:t==="vertical"?r:void 0},t==="vertical"?d:r)]}_renderDuplicateButton(){if(!this.visibleElements.duplicateButton)return[];const{messages:t}=this;return this._renderToolbarItem({id:"duplicate",text:this.updateGraphics.length>1?t.duplicateFeatures:t.duplicateFeature,icon:"copy",onclick:this._onDuplicateSelect})}_renderDeleteButton(){if(!this.visibleElements.deleteButton)return[];const{messages:t}=this,e=this.updateGraphics.length>1?t.deleteFeatures:t.deleteFeature;return this._renderToolbarItem({id:"delete",text:e,icon:"trash",onclick:this.delete})}_renderToolbarItem({id:t,text:e,icon:i,disabled:o,onclick:n,active:r,flipRTL:a,afterCreate:d,afterUpdate:u,afterRemoved:p}){const h=`${this.id}-${t}`;return[c("calcite-action",{active:r,afterCreate:d,afterRemoved:p,afterUpdate:u,bind:this,"data-testid":t,disabled:o||this.state==="disabled",icon:i,iconFlipRtl:a??!1,id:h,key:t,onclick:n,scale:this.scale,text:e,title:e})]}_remeasurePopoverSizes(t){var e,i,o,n,r,a;try{const d=t.parentElement,u=(i=(e=this==null?void 0:this.view)==null?void 0:e.container)==null?void 0:i.getBoundingClientRect(),p=d==null?void 0:d.style;if(!(d&&u&&p&&((n=(o=this.view)==null?void 0:o.container)!=null&&n.contains(d))))return;const h=this._calcitePopoverReferenceElement;if(!h)return;const{bottom:b,top:y}=h.getBoundingClientRect();if(this.layout==="horizontal"){const M=b<u.height/2;M!==(this._relativeLocation==="top")&&(this._relativeLocation=M?"top":"bottom"),M?(p==null||p.setProperty("--sketch-view-height-offset",b-u.top+"px"),p==null||p.setProperty("--sketch-view-margin-offset","30px")):(p==null||p.setProperty("--sketch-view-height-offset",u.bottom-y+"px"),p==null||p.setProperty("--sketch-view-margin-offset","15px"))}else this.layout==="vertical"&&(p.setProperty("--sketch-view-height-offset","15px"),p.setProperty("--sketch-view-margin-offset","15px"));const w=(a=(r=t.shadowRoot)==null?void 0:r.querySelector("div.header"))==null?void 0:a.getBoundingClientRect().height;p.setProperty("--sketch-popover-header-offset",`${w}px`)}catch(d){ye.getLogger(this.declaredClass).warnOnce("Sketch failed to lay out settings menu.",d)}}_activateCreateTool(t,e,i){var n;const o=this._activeCustomToolOptions;if(i||o){if((i==null?void 0:i.toolKey)===(o==null?void 0:o.toolKey))return void this.cancel()}else if(this.activeTool===t)return void this.cancel();(n=this._selectionToolbar)==null||n.cancel(),this.create(t,e,i)}_onDuplicateSelect(){const t=this.duplicate(),e=this.viewModel.activeTool;e!=="transform"&&e!=="reshape"||this.update(t,{tool:e})}_onSelectionOperationComplete(t){const{viewModel:{defaultUpdateOptions:e}}=this,{selection:i}=t;if(!t.aborted&&i.length){const o=e.tool,n=i.length>1&&o==="reshape"?"transform":o;this.update(i,{...e,tool:n})}this.notifyChange("state")}_activateDefaultSelectTool(){var t;this.cancel(),(t=this.view)==null||t.focus()}_refocusOnView(){var t;this.activeTool&&((t=this.view)==null||t.focus())}};s([l()],g.prototype,"_activeCustomToolOptions",void 0),s([l()],g.prototype,"activeTool",null),s([l({readOnly:!0})],g.prototype,"activeTooltip",null),s([l({cast:t=>{if(!(t!=null&&t.length))return null;const e=new Set(["point","polyline","polygon","rectangle","circle","multipoint","freehandPolyline","freehandPolygon","mesh"]);return t.filter(i=>e.has(i))}})],g.prototype,"availableCreateTools",void 0),s([l({readOnly:!0})],g.prototype,"createGraphic",null),s([l()],g.prototype,"creationMode",null),s([l()],g.prototype,"customToolOptions",void 0),s([l()],g.prototype,"customActions",void 0),s([l()],g.prototype,"defaultCreateOptions",null),s([l()],g.prototype,"defaultUpdateOptions",null),s([l()],g.prototype,"icon",null),s([l()],g.prototype,"label",null),s([l()],g.prototype,"labelOptions",null),s([l()],g.prototype,"layer",null),s([l({type:["horizontal","vertical"],value:"horizontal"})],g.prototype,"layout",null),s([l({value:"m"})],g.prototype,"scale",null),s([l()],g.prototype,"toolbarKind",void 0),s([l()],g.prototype,"contextualToolLocation",void 0),s([l()],g.prototype,"groupCollapsePriorities",void 0),s([l(),J("esri/widgets/Sketch/t9n/Sketch")],g.prototype,"messages",void 0),s([l(),J("esri/t9n/common")],g.prototype,"messagesCommon",void 0),s([l()],g.prototype,"snappingOptions",null),s([l()],g.prototype,"state",null),s([l()],g.prototype,"tooltipOptions",null),s([l({readOnly:!0})],g.prototype,"updateGraphics",null),s([l({type:Gt,nonNullable:!0})],g.prototype,"valueOptions",null),s([l()],g.prototype,"view",null),s([l({type:nt}),ti(["create","update","undo","redo"])],g.prototype,"viewModel",null),s([l({type:O,nonNullable:!0})],g.prototype,"visibleElements",void 0),s([l()],g.prototype,"_effectiveAvailableCreateTools",null),s([l()],g.prototype,"_defaultViewModel",void 0),s([l()],g.prototype,"_calcitePopoverReferenceElement",void 0),s([l()],g.prototype,"_relativeLocation",void 0),s([l()],g.prototype,"_popoverOpen",void 0),g=s([_("esri.widgets.Sketch")],g);const Fi=g,vo=Object.freeze(Object.defineProperty({__proto__:null,default:Fi},Symbol.toStringTag,{value:"Module"}));export{vo as S,ae as o,at as r,ht as t};
