import{fA as E,fB as I,fC as w,eD as f,fD as c,fE as A,fF as F,fG as T,fH as R,fI as g,fJ as O,fK as D,bv as b,fL as d}from"./index-CfYeSufM.js";function j(t,e,a=null){const n=[],l=e.mapPositions;m(e,n);const o=n[0][1].data,u=n[0][1].indices.length,r=E(u);return v(e,n,r),C(e,n,r),y(e,n,r),S(e,n,r),U(e,n,r),L(e,n,r),z(e,n,o),new I(t,n,l,w.Line,a)}function m(t,e){const{attributeData:{position:a},removeDuplicateStartEnd:n}=t,l=B(a)&&n,o=a.length/3-(l?1:0),u=new Array(2*(o-1)),r=l?a.slice(0,-3):a;let i=0;for(let h=0;h<o-1;h++)u[i++]=h,u[i++]=h+1;e.push([f.POSITION,new c(r,u,3,l)])}function v(t,e,a){if(t.attributeData.colorFeature!=null)return;const n=t.attributeData.color;e.push([f.COLOR,new c(n??A,a,4)])}function y(t,e,a){t.attributeData.normal&&e.push([f.NORMAL,new c(t.attributeData.normal,a,3)])}function S(t,e,a){t.attributeData.colorFeature!=null&&e.push([f.COLORFEATUREATTRIBUTE,new c([t.attributeData.colorFeature],a,1,!0)])}function C(t,e,a){t.attributeData.sizeFeature==null&&e.push([f.SIZE,new c([t.attributeData.size??1],a,1,!0)])}function U(t,e,a){t.attributeData.sizeFeature!=null&&e.push([f.SIZEFEATUREATTRIBUTE,new c([t.attributeData.sizeFeature],a,1,!0)])}function L(t,e,a){t.attributeData.opacityFeature!=null&&e.push([f.OPACITYFEATUREATTRIBUTE,new c([t.attributeData.opacityFeature],a,1,!0)])}function z(t,e,a){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==F.Global||!t.overlayInfo.spatialReference.isGeographic)return;const n=T(a.length),l=R(t.overlayInfo.spatialReference);for(let s=0;s<n.length;s+=3)g(a,s,n,s,l);const o=a.length/3,u=O(o+1);let r=G,i=N,h=0,p=0;D(r,n[p++],n[p++]),p++,u[0]=0;for(let s=1;s<o+1;++s)s===o&&(p=0),D(i,n[p++],n[p++]),p++,h+=d(r,i),u[s]=h,[r,i]=[i,r];e.push([f.DISTANCETOSTART,new c(u,e[0][1].indices,1,!0)])}function B(t){const e=t.length;return t[0]===t[e-3]&&t[1]===t[e-2]&&t[2]===t[e-1]}const G=b(),N=b();function H(t,e){if(t==null||t.length===0)return[];const a=[];return t.forEach(n=>{const l=n.length,o=T(3*l);n.forEach((r,i)=>{o[3*i]=r[0],o[3*i+1]=r[1],o[3*i+2]=r[2]});const u={attributeData:{position:o,normal:e},removeDuplicateStartEnd:!1};a.push(u)}),a}export{H as R,j as b};
