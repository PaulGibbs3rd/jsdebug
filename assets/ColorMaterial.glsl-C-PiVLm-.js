import{t_ as y,CO as E,CP as b,Ea as S,Eb as I,CS as N,CR as R,CT as w,CQ as L,eD as p,DN as M,CV as _,CW as x,CZ as F,C_ as V,_ as q,C$ as O,D0 as U,D1 as j,D2 as B,D3 as H,D4 as W,D5 as z,DA as Q,D6 as G,D7 as J,D8 as X,D9 as Y,DO as Z,oL as C,Dc as T,Dd as k,oX as v,qD as K,De as ee,b as r,Df as i,oM as l,Ec as f,DC as g,Ed as te,Di as se,qH as ae,eC as re,Dl as ie,Ee as oe,E9 as ne,rU as le,DP as pe}from"./index-CzvLtnX1.js";import{e as ue}from"./TriangleMaterial-DGLj9Hvg.js";function D(s){const e=new y,{vertex:t,fragment:o,attributes:n,varyings:u}=e,{vvColor:c,hasVertexColors:h}=s;return E(t,s),e.include(b,s),e.include(S,s),e.include(I,s),e.include(N,s),o.include(R,s),e.include(w,s),e.include(L,s),n.add(p.POSITION,"vec3"),c&&n.add(p.COLORFEATUREATTRIBUTE,"float"),h||u.add("vColor","vec4"),u.add("vpos","vec3"),t.uniforms.add(new M("uColor",d=>d.color)),t.main.add(_`
      vpos = position;
      forwardNormalizedVertexColor();
      forwardObjectAndLayerIdColor();

      ${h?"vColor *= uColor;":c?"vColor = uColor * interpolateVVColor(colorFeatureAttribute);":"vColor = uColor;"}
      forwardViewPosDepth((view * vec4(vpos, 1.0)).xyz);
      gl_Position = transformPosition(proj, view, vpos);`),o.include(x),o.main.add(_`discardBySlice(vpos);
discardByTerrainDepth();
outputColorHighlightOID(vColor, vpos);`),e}const ce=Object.freeze(Object.defineProperty({__proto__:null,build:D},Symbol.toStringTag,{value:"Module"}));class he extends F{constructor(e,t){super(e,t,new V(ce,()=>q(()=>Promise.resolve().then(()=>_e),void 0)))}_createPipeline(e,t){const{oitPass:o,output:n,transparent:u,cullFace:c,draped:h,hasOccludees:d,polygonOffset:A,enableOffset:P}=e,m=o===O.NONE,$=o===O.FrontFace;return U({blending:T(n)&&u?Z(o):null,culling:Y(c),depthTest:h?null:{func:X(o)},depthWrite:J(e),drawBuffers:n===C.Depth?{buffers:[Q.NONE]}:G(o,n),colorWrite:z,stencilWrite:d?W:null,stencilTest:d?t?B:H:null,polygonOffset:m||$?A?de:null:j(P)})}initializePipeline(e){return this._occludeePipelineState=this._createPipeline(e,!0),this._createPipeline(e,!1)}getPipeline(e){return e?this._occludeePipelineState:super.getPipeline()}}const de={factor:1,units:1};class a extends k{constructor(){super(...arguments),this.cullFace=v.None,this.hasVertexColors=!1,this.transparent=!1,this.discardInvisibleFragments=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.objectAndLayerIdColorInstanced=!1,this.vvColor=!1,this.draped=!1,this.textureCoordinateType=K.None,this.emissionSource=ee.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.vvSize=!1,this.vvOpacity=!1}}r([i({count:v.COUNT})],a.prototype,"cullFace",void 0),r([i()],a.prototype,"hasVertexColors",void 0),r([i()],a.prototype,"transparent",void 0),r([i()],a.prototype,"discardInvisibleFragments",void 0),r([i()],a.prototype,"polygonOffset",void 0),r([i()],a.prototype,"enableOffset",void 0),r([i()],a.prototype,"writeDepth",void 0),r([i()],a.prototype,"hasOccludees",void 0),r([i()],a.prototype,"terrainDepthTest",void 0),r([i()],a.prototype,"cullAboveTerrain",void 0),r([i()],a.prototype,"objectAndLayerIdColorInstanced",void 0),r([i()],a.prototype,"vvColor",void 0),r([i()],a.prototype,"draped",void 0);class Ce extends ue{constructor(e){super(e,ve),this._configuration=new a,this.supportsEdges=!0,this.produces=new Map([[l.OPAQUE_MATERIAL,t=>this._isOpaqueMaterialPass(t)],[l.OPAQUE_MATERIAL_WITHOUT_NORMALS,t=>this._isOpaqueNoSSAODepthPass(t)],[l.TRANSPARENT_MATERIAL,t=>f(t)&&this._transparent&&this.parameters.writeDepth],[l.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,t=>g(t)&&this._transparent&&this.parameters.writeDepth],[l.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,t=>f(t)&&this._transparent&&!this.parameters.writeDepth],[l.DRAPED_MATERIAL,t=>te(t)]])}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._transparent,this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(e)&&this.parameters.discardInvisibleFragments,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=t.hasOccludees,this._configuration.oitPass=t.oitPass,this._configuration.enableOffset=t.camera.relativeElevation<se,this._configuration.terrainDepthTest=t.terrainDepthTest&&T(e),this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.draped=this.parameters.draped,this._configuration}get visible(){return this.parameters.color[3]>=ae}get _transparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}_isOpaquePass(e){return this._isOpaqueMaterialPass(e)||this._isOpaqueNoSSAODepthPass(e)}_isOpaqueMaterialPass(e){return e===C.Highlight||f(e)&&!this._transparent}_isOpaqueNoSSAODepthPass(e){return g(e)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(e){return new fe(e)}createBufferWriter(){const e=re().vec3f(p.POSITION);return oe()&&e.vec4u8(p.OBJECTANDLAYERIDCOLOR),this.parameters.vvColor?e.f32(p.COLORFEATUREATTRIBUTE):e.vec4u8(p.COLOR),new ie(e)}}class fe extends pe{beginSlot(e){return this.getTechnique(he,e)}}class ve extends ne{constructor(){super(...arguments),this.color=le,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=v.None,this.draped=!1,this.discardInvisibleFragments=!1}}const _e=Object.freeze(Object.defineProperty({__proto__:null,build:D},Symbol.toStringTag,{value:"Module"}));export{Ce as A};
